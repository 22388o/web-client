(this["webpackJsonpshockwallet-web"]=this["webpackJsonpshockwallet-web"]||[]).push([[4],{269:function(e,t){},271:function(e,t){},279:function(e,t){},281:function(e,t){},291:function(e,t){},293:function(e,t){},301:function(e,t){},303:function(e,t){},308:function(e,t){},311:function(e,t){},312:function(e,t){},314:function(e,t){},316:function(e,t){},318:function(e,t){},332:function(e,t){},334:function(e,t){},339:function(e,t){},344:function(e,t){},346:function(e,t){},352:function(e,t){},354:function(e,t){},355:function(e,t){},356:function(e,t){},360:function(e,t){},362:function(e,t){},367:function(e,t){},371:function(e,t){},372:function(e,t){},376:function(e,t){},379:function(e,t){},382:function(e,t){},384:function(e,t){},394:function(e,t){},396:function(e,t){},406:function(e,t){},408:function(e,t){},422:function(e,t){},424:function(e,t){},434:function(e,t){},436:function(e,t){},443:function(e,t){},445:function(e,t,n){e.exports=n.p+"static/media/banner-bg.f59337b5.jpg"},446:function(e,t,n){e.exports=n.p+"static/media/av1.48bf5c6a.jpg"},447:function(e,t,n){e.exports=n.p+"static/media/lightning-logo.ea3bd789.svg"},448:function(e,t,n){},453:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n.n(a),r=n(6),o=n(9),i=n(0),u=n.n(i),s=n(32),l=n(5),f=n(248),m=n.n(f),p=n(148),d=n.n(p),b=n(257),v=n.n(b),O=n(11),g=n(38),j=n(22),h=n(1),E=n(23),N=n(4),w=n(261),k=n.n(w),S=n(444),y=n.n(S),x=function(){var e=Object(r.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,y.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){y.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),y.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,y.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src=e,t.muted=!0,t.autoplay=!0})),!!n&&!!n.length},I=function(e,t){return y.a.save(e,t)},P=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},A={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},T=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(A).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];if(c){var r=Object(o.a)(c,2),i=r[0],u=r[1];return Object(N.a)({name:i},u)}return null},R=new k.a,L=n(35),U=n(445),q=n.n(U),V=n(446),W=n.n(V),z=n(447),B=n.n(z),Y=(n(448),n(33)),D=u.a.lazy((function(){return Promise.all([n.e(6),n.e(5)]).then(n.bind(null,452))}));t.default=function(){var e,t=Object(s.b)(),n=Object(l.g)(),a=Object(s.c)((function(e){return e.user.wall})),f=Object(s.c)((function(e){return e.user.profile})),p=Object(s.c)((function(e){return e.auth.pair})),b=Object(s.c)((function(e){return e.transaction.paymentRequest})),N=Object(i.useState)(!0),w=Object(o.a)(N,2),k=(w[0],w[1]),S=Object(i.useState)(!0),y=Object(o.a)(S,2),U=y[0],V=y[1],z=Object(i.useState)(!1),F=Object(o.a)(z,2),J=F[0],K=F[1],M=Object(i.useState)(!1),Q=Object(o.a)(M,2),_=Q[0],G=Q[1],H=Object(i.useState)(10),X=Object(o.a)(H,2),Z=X[0],$=X[1],ee=Object(i.useState)(!1),te=Object(o.a)(ee,2),ne=te[0],ae=te[1],ce=Object(i.useState)(!1),re=Object(o.a)(ce,2),oe=re[0],ie=re[1],ue=Object(i.useState)(!1),se=Object(o.a)(ue,2),le=se[0],fe=se[1],me=Object(i.useState)(null),pe=Object(o.a)(me,2),de=pe[0],be=pe[1],ve=Object(i.useState)({targetType:"user"}),Oe=Object(o.a)(ve,2),ge=Oe[0],je=Oe[1],he=n.userId,Ee=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k(!0),t(Object(O.f)()),e.next=5,t(Object(O.d)(he));case 5:return n=e.sent,console.log(n),k(!1),t(Object(O.c)(he)),e.next=11,t(Object(O.b)(he));case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),k(!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])}))),[t,he]),Ne=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Setting Loading status to:",!0),V(!0),t(Object(O.g)()),e.next=6,t(Object(O.e)(he));case 6:console.log("Setting Loading status to:",!1),V(!1),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),console.log("Setting Loading status to:",!1),V(!1);case 15:case"end":return e.stop()}}),e,null,[[0,10]])}))),[t,he]),we=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G(!0),e.next=4,t(Object(j.b)({senderPair:p,recipientPublicKey:he,amount:Z,metadata:ge}));case 4:G(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[t,p,he,Z,ge]),ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{targetType:"user"};je(e),K(!0)},Se=Object(i.useCallback)((function(){K(!1),je({}),b&&(t(Object(j.c)()),G(!1))}),[t,b]),ye=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee();case 2:return e.next=4,t(Object(g.b)());case 4:Ne();case 5:case"end":return e.stop()}}),e)}))),[t,Ee,Ne]);Object(i.useEffect)((function(){ye();var e=Object(h.h)({path:"Profile/lastSeenApp",gunPointer:Object(h.g)(he),callback:function(e){t(Object(O.h)({lastSeenApp:e}))}}),n=Object(h.h)({path:"Profile/lastSeenNode",gunPointer:Object(h.g)(he),callback:function(e){t(Object(O.h)({lastSeenNode:e}))}}),a=Object(h.h)({path:"Profile/displayName",gunPointer:Object(h.g)(he),callback:function(e){t(Object(O.h)({displayName:e}))}}),c=Object(h.h)({path:"Profile/bio",gunPointer:Object(h.g)(he),callback:function(e){t(Object(O.h)({bio:e}))}});return function(){e.off(),n.off(),a.off(),c.off()}}),[t,ye,he]),Object(i.useEffect)((function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.map((function(e){var n=e.contentItems,a=e.id;return Object.entries(n).filter((function(e){var t=Object(o.a)(e,2),n=(t[0],t[1]);return A[n.type]})).map((function(e){var n=Object(o.a)(e,2),i=n[0],u=n[1];return function(){return new Promise((function(e){R.get(u.magnetURI)?e(!0):R.add(u.magnetURI,function(){var n=Object(r.a)(c.a.mark((function n(s){var l;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(!0),(l=s.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(A).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];return!!c&&Object(o.a)(c,2)[1].formats.includes(a)}))).map(function(){var e=Object(r.a)(c.a.mark((function e(n){var r,s,l,f,m,p,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=T(n)){e.next=3;break}return e.abrupt("return");case 3:return s="".concat(a,"-").concat(i,"-").concat(n.name),l=r.element,f="".concat(l,'[data-torrent="').concat(u.magnetURI,'"]'),e.next=8,x(s);case 8:if(!(m=e.sent)){e.next=14;break}return(p=R.get(u.magnetURI))&&p.destroy(),C(m,f),e.abrupt("return");case 14:d=document.querySelectorAll(f),console.log("Torrent Elements:",d),d.forEach((function(e){var a=decodeURIComponent(u.magnetURI.replace(/.*(ws=)/gi,"")),c=r.formats.filter((function(e){return a.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),i=Object(o.a)(c,1)[0];!t&&i?e.setAttribute("src",a):n.renderTo(e,r.options)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),s.on("done",(function(){l.map((function(e){var t=T(e),n="".concat(a,"-").concat(i,"-").concat(e.name),o=t.element,s="".concat(o,'[data-torrent="').concat(u.magnetURI,'"]');e.getBlob(function(){var e=Object(r.a)(c.a.mark((function e(t,a){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",n,a),e.next=6,I(n,a);case 6:if("false"!==document.querySelector(s).dataset.played){e.next=12;break}return e.next=10,x(n);case 10:r=e.sent,C(r,s);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}))}}))})).reduce((function(e,t){return[].concat(Object(E.a)(e),Object(E.a)(t))}),[]);P(n)}(a.posts,!1)}),[a.posts]),Object(i.useEffect)((function(){de&&clearTimeout(de);var e=setTimeout((function(){var e=d.a.utc().subtract(3e4,"ms"),t=!!f.lastSeenNode&&d.a.utc(f.lastSeenNode).isSameOrAfter(e),n=!!f.lastSeenApp&&d.a.utc(f.lastSeenApp).isSameOrAfter(e);ie(t),ae(n)}),3e4);return be(e),function(){return clearTimeout(de)}}),[f]),Object(i.useEffect)((function(){var e=d.a.utc().subtract(1,"minutes"),t=!!(null===f||void 0===f?void 0:f.lastSeenNode)&&d.a.utc(null===f||void 0===f?void 0:f.lastSeenNode).isSameOrAfter(e),n=!!(null===f||void 0===f?void 0:f.lastSeenApp)&&d.a.utc(null===f||void 0===f?void 0:f.lastSeenApp).isSameOrAfter(e);ie(t),ae(n)}),[f]);var xe=Object(i.useCallback)((function(){fe(!0),Y.a.rebuild(),setTimeout((function(){fe(!1),Y.a.rebuild()}),500)}),[]),Ce=null!==(e=f.displayName)&&void 0!==e?e:f.alias;return u.a.createElement("div",{className:"user-page"},u.a.createElement("div",{className:"top-banner",style:{backgroundImage:"url(".concat(f.header?"data:image/png;base64,".concat(f.header):q.a,")")}}),u.a.createElement("div",{className:"user-details"},u.a.createElement("div",{className:"main-av",style:{backgroundImage:"url(".concat(f.avatar?"data:image/png;base64,".concat(f.avatar):W.a,")")}}),u.a.createElement("div",{className:"details"},u.a.createElement("div",{className:"user-info"},u.a.createElement("p",{className:"username"},Ce),u.a.createElement("div",{className:"activity"},u.a.createElement("p",{className:"status",style:ne?{}:{color:ne?"#01a33d":oe?"#f2a900":"#888"}},ne?"Active Recently":oe?"Node Online":"Node Offline")),f.bio?u.a.createElement("div",{className:"desc"},u.a.createElement("p",{className:"title"},"Bio"),u.a.createElement("p",null,f.bio)):null),u.a.createElement("div",{className:"send-tip-btn",onClick:function(){return ke()},style:{opacity:oe?1:.5,cursor:oe?"pointer":"default"},"data-tip":oe?null:"You can only tip users with online nodes"},u.a.createElement("img",{src:B.a,alt:"Bitcoin Lightning"}),u.a.createElement("p",null,"Send Tip")))),u.a.createElement("div",{className:"tabs-holder"},u.a.createElement("p",{className:"tab active"},"Feed")),u.a.createElement("div",{className:"posts-holder"},a.posts.map((function(e){var t,n;return u.a.createElement(i.Suspense,{fallback:u.a.createElement("div",{className:"post-loading"},u.a.createElement(L.a,{text:"Loading Post..."})),key:e.id},u.a.createElement(D,{timestamp:e.date,contentItems:e.contentItems,username:Ce,avatar:f.avatar?"data:image/png;base64,".concat(f.avatar):W.a,publicKey:he,openTipModal:ke,webTorrentClient:R,page:e.page,id:e.id,tipValue:null!==(t=e.tipValue)&&void 0!==t?t:0,tipCounter:null!==(n=e.tipCounter)&&void 0!==n?n:0,isOnlineNode:oe}))}))),U?u.a.createElement(L.a,{text:"Loading ".concat(a.page>=0?"More":"Wall"," Posts...")}):null,J?u.a.createElement("div",{className:"tip-modal-container"},u.a.createElement("div",{className:"tip-modal-overlay",onClick:Se}),u.a.createElement("div",{className:"tip-modal"},_?u.a.createElement("div",{className:"tip-modal-loading"},u.a.createElement(L.a,{text:"Submitting Tip Request..."})):null,u.a.createElement("div",{className:"tip-modal-head"},u.a.createElement("div",{className:"tip-modal-title"},"Send Tip")),b?u.a.createElement("div",{className:"tip-modal-content"},u.a.createElement("p",{className:"tip-modal-instructions"},"We've successfully generated an invoice for you to tip, please scan the QR Code below using a Lightning wallet to pay it!"),u.a.createElement("div",{className:"tip-modal-qr-code-container"},u.a.createElement(m.a,{className:"tip-modal-qr-code",value:b,size:210,bgColor:"#4db1ff",fgColor:"#1b2129"})),u.a.createElement("div",{className:"tip-modal-action-btns"},u.a.createElement("a",{href:"lightning:".concat(b),className:"tip-modal-action-btn"},"PAY INVOICE"),u.a.createElement(v.a,{text:b,onCopy:xe},u.a.createElement("div",{className:"tip-modal-action-btn"},le?"INVOICE COPIED!":"COPY INVOICE")))):u.a.createElement("div",{className:"tip-modal-content"},u.a.createElement("p",{className:"tip-modal-instructions"},"Please specify the amount of sats you'd like to tip this user with below and we'll generate an invoice for you to scan."),u.a.createElement("input",{className:"tip-modal-input",value:Z,onChange:function(e){return $(e.target.value)}})),b?null:u.a.createElement("div",{className:"tip-modal-footer",onClick:function(){return we()}},u.a.createElement("div",{className:"tip-modal-submit"},"SEND TIP")))):null)}}}]);
//# sourceMappingURL=4.b5dc913b.chunk.js.map