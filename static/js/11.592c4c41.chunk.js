(this["webpackJsonpshockwallet-web"]=this["webpackJsonpshockwallet-web"]||[]).push([[11],{114:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(17),r=n(2),c=n.n(r),u=n(6),o=n(3),i=n(8),s=n(164),l=n.n(s),f=function(){var e=Object(u.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){l.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),l.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,l.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src=e,t.muted=!0,t.autoplay=!0})),!!n&&!!n.length},b=function(e,t){return l.a.save(e,t)},m=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},d={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},v=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],r=Object.entries(d).filter((function(e){var t=Object(i.a)(e,2);t[0];return t[1].formats.includes(a)})),c=Object(i.a)(r,1)[0];if(c){var u=Object(i.a)(c,2),s=u[0],l=u[1];return Object(o.a)({name:s},l)}return null},O=null,j=function(){var e=Object(u.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=5;break}return e.next=3,Promise.all([n.e(6),n.e(8)]).then(n.t.bind(null,538,7));case 3:t=e.sent,O=new t.default;case 5:return e.abrupt("return",O);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(u.a)(c.a.mark((function e(){var t,n,r,o,s=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:[],n=!(s.length>1&&void 0!==s[1])||s[1],e.next=4,Promise.all(t.map(function(){var e=Object(u.a)(c.a.mark((function e(t){var a,r,o,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.contentItems,r=t.id,o=Object.entries(a).filter((function(e){var t=Object(i.a)(e,2)[1];return d[t.type]}))){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,j();case 6:return s=e.sent,e.abrupt("return",o.map((function(e){var t=Object(i.a)(e,2),a=t[0],o=t[1];return function(){return new Promise((function(e){s.get(o.magnetURI)?e(!0):s.add(o.magnetURI,function(){var t=Object(u.a)(c.a.mark((function t(l){var m;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(!0),(m=l.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],r=Object.entries(d).filter((function(e){return Object(i.a)(e,2)[1].formats.includes(a)}))[0];return!!r&&Object(i.a)(r,2)[1].formats.includes(a)}))).map(function(){var e=Object(u.a)(c.a.mark((function e(t){var u,l,b,m,d,O,j;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=v(t)){e.next=3;break}return e.abrupt("return");case 3:return l="".concat(r,"-").concat(a,"-").concat(t.name),b=u.element,m="".concat(b,'[data-torrent="').concat(o.magnetURI,'"]'),e.next=8,f(l);case 8:if(!(d=e.sent)){e.next=14;break}return(O=s.get(o.magnetURI))&&O.destroy(),p(d,m),e.abrupt("return");case 14:j=document.querySelectorAll(m),console.log("Torrent Elements:",j),j.forEach((function(e){var a=decodeURIComponent(o.magnetURI.replace(/.*(ws=)/gi,"")),r=u.formats.filter((function(e){return a.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),c=Object(i.a)(r,1)[0];!n&&c?e.setAttribute("src",a):t.renderTo(e,u.options)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l.on("done",(function(){m.map((function(e){var t=v(e),n="".concat(r,"-").concat(a,"-").concat(e.name),i=t.element,s="".concat(i,'[data-torrent="').concat(o.magnetURI,'"]');e.getBlob(function(){var e=Object(u.a)(c.a.mark((function e(t,a){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",n,a),e.next=6,b(n,a);case 6:if("false"!==document.querySelector(s).dataset.played){e.next=12;break}return e.next=10,f(n);case 10:r=e.sent,p(r,s);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:r=e.sent,o=r.reduce((function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(t))}),[]),m(o);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},116:function(e,t,n){e.exports=n.p+"static/media/av1.48bf5c6a.jpg"},130:function(e,t,n){"use strict";var a=n(8),r=n(0),c=n(32),u=n(115),o=n.n(u),i=n(1);t.a=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.user.profile})),u=Object(r.useState)(!1),s=Object(a.a)(u,2),l=s[0],f=s[1],p=Object(r.useState)(!1),b=Object(a.a)(p,2),m=b[0],d=b[1],v=Object(r.useState)(!1),O=Object(a.a)(v,2),j=O[0],h=O[1],g=Object(r.useState)(!1),k=Object(a.a)(g,2),w=k[0],x=k[1],y=Object(r.useState)(),E=Object(a.a)(y,2),P=E[0],S=E[1],N=Object(r.useCallback)((function(){var e=o.a.utc().subtract(1,"minutes"),t=o.a.utc(m).isSameOrAfter(e),n=o.a.utc(l).isSameOrAfter(e);x(t),h(n)}),[l,m]);return Object(r.useEffect)((function(){P&&clearTimeout(P),N();var e=setTimeout((function(){N()}),3e4);return S(e),function(){return clearTimeout(P)}}),[n,N]),Object(r.useEffect)((function(){var t=Object(i.h)({path:"Profile/lastSeenApp",gunPointer:Object(i.g)(e),callback:function(e){f(e)}}),n=Object(i.h)({path:"Profile/lastSeenNode",gunPointer:Object(i.g)(e),callback:function(e){d(e)}});return function(){t.off(),n.off()}}),[t,e]),{isOnlineApp:j,isOnlineNode:w}}},131:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(32),u=n(16),o=n(33),i=(n(132),r.a.lazy((function(){return Promise.all([n.e(2),n.e(9),n.e(14)]).then(n.bind(null,272))})));t.a=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.tip.modalOpen})),s=Object(a.useCallback)((function(){t(Object(u.b)())}),[t]),l=Object(a.useMemo)((function(){return r.a.createElement(o.a,{text:"Loading..."})}),[]);return n?r.a.createElement("div",{className:"modal-container"},r.a.createElement("div",{className:"modal-overlay",onClick:s}),r.a.createElement("div",{className:"modal-content"},r.a.createElement(a.Suspense,{fallback:l},r.a.createElement(i,e)))):null}},132:function(e,t,n){},283:function(e,t,n){},284:function(e,t,n){},541:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(6),u=n(8),o=n(0),i=n.n(o),s=n(32),l=n(5),f=n(13),p=(n(114),n(130)),b=n(33),m=(n(283),i.a.createElement("div",{className:"navbar-icon"})),d=function(e){var t=e.title,n=e.goBack;return i.a.createElement("div",{className:"navbar"},n?i.a.createElement("div",{className:"navbar-icon",onClick:n},i.a.createElement("i",{className:"fas fa-arrow-left"})):m,i.a.createElement("p",{className:"navbar-title"},t),m)},v=n(116),O=n.n(v),j=(n(284),n(131)),h=i.a.lazy((function(){return Promise.all([n.e(0),n.e(2),n.e(1)]).then(n.bind(null,277))})),g=i.a.lazy((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(13)]).then(n.bind(null,535))}));t.default=function(){var e=Object(s.b)(),t=Object(l.h)(),n=t.postId,a=t.type,m=t.userId,v=Object(l.g)(),k=Object(s.c)((function(e){return e.user.profile})),w=Object(s.c)((function(e){var t;return null===(t=e.user.wall)||void 0===t?void 0:t.pinnedPost})),x=Object(o.useState)(!0),y=Object(u.a)(x,2),E=y[0],P=y[1],S=Object(p.a)(m).isOnlineNode,N=Object(o.useMemo)((function(){var e,t;return null!==(e=null!==(t=k.displayName)&&void 0!==t?t:k.alias)&&void 0!==e?e:"POSTS"}),[k.alias,k.displayName]),C=Object(o.useCallback)(Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(Object(f.i)()),t.next=3,e(Object(f.g)(m));case 3:e(Object(f.d)(m));case 4:case"end":return t.stop()}}),t)}))),[e,m]),I=Object(o.useCallback)(Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(Object(f.c)({postId:n,type:a,publicKey:m}));case 1:case"end":return t.stop()}}),t)}))),[e,n,a,m]),A=Object(o.useCallback)(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,C();case 3:I(),P(!1);case 5:case"end":return e.stop()}}),e)}))),[I,C]),U=Object(o.useCallback)((function(){v.push("/".concat(m))}),[v,m]),R=Object(o.useCallback)((function(e){if(e){var t,n,a=k.avatar?"data:image/png;base64,".concat(k.avatar):O.a;if("shared"===e.type)return i.a.createElement(o.Suspense,{fallback:i.a.createElement("div",{className:"post-loading"},i.a.createElement(b.a,{text:"Loading Post..."})),key:e.id},i.a.createElement(g,{postID:e.id,postPublicKey:e.originalAuthor,sharedPostId:e.id,sharedTimestamp:e.date,sharerAvatar:a,sharerPublicKey:m,sharerUsername:N,isOnlineNode:S}));if("post"===e.type)return i.a.createElement(o.Suspense,{fallback:i.a.createElement("div",{className:"post-loading"},i.a.createElement(b.a,{text:"Loading Post..."})),key:e.id},i.a.createElement(h,{timestamp:e.date,contentItems:e.contentItems,username:N,avatar:a,publicKey:m,page:e.page,id:e.id,tipValue:null!==(t=e.tipValue)&&void 0!==t?t:0,tipCounter:null!==(n=e.tipCounter)&&void 0!==n?n:0,isOnlineNode:S,pinned:!0}))}}),[S,k.avatar,m,N]);return Object(o.useEffect)((function(){A()}),[A]),E?i.a.createElement(b.a,{text:"Loading Post..."}):i.a.createElement("div",{className:"post-page has-nav"},i.a.createElement(d,{title:N,goBack:U}),i.a.createElement("div",{className:"posts-container"},R(w)),i.a.createElement(j.a,{publicKey:m}))}}}]);
//# sourceMappingURL=11.592c4c41.chunk.js.map