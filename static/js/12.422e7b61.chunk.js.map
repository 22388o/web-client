{"version":3,"sources":["utils/Promise.js","common/Post/components/NoticeBar/index.js","common/Post/SharedPost.js"],"names":["runSerial","tasks","result","Promise","resolve","forEach","task","then","crawlerAwait","a","isCrawler","promises","all","NoticeBar","icon","text","visible","className","SharedPost","sharedPostId","sharerPublicKey","sharerUsername","sharerAvatar","sharedTimestamp","isOnlineNode","postID","postPublicKey","pinned","dispatch","useDispatch","useState","postLoading","setPostLoading","postContent","setPostContent","postUser","setPostUser","useEffect","listenPath","path","gunPointer","gunUser","callback","data","updateWallPost","tipCounter","tipValue","loadPostUser","useCallback","getUserWallPostInfo","publicKey","id","userInfo","loadPostContent","getUserWallPostContent","userPost","attachMedia","loadPost","Tooltip","rebuild","style","backgroundImage","moment","utc","fromNow","Loader","Post","timestamp","date","avatar","av1","contentItems","username","displayName","alias","shared"],"mappings":"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","file":"static/js/12.422e7b61.chunk.js","sourcesContent":["import { isCrawler } from \"./Prerender\";\n\nexport const runSerial = tasks => {\n  let result = Promise.resolve();\n  tasks.forEach(task => {\n    result = result.then(() => task());\n  });\n  return result;\n};\n\nexport const crawlerAwait = async (...promises) => {\n  if (isCrawler()) {\n    return await Promise.all(promises);\n  }\n};\n","import React from \"react\";\nimport \"./css/index.css\";\n\nconst NoticeBar = ({ icon = \"link\", text, visible }) => {\n  if (!visible) {\n    return null;\n  }\n\n  return (\n    <div className=\"notice-bar\">\n      <i className={`fas fa-${icon}`} />\n      {text}\n    </div>\n  );\n};\n\nexport default NoticeBar;\n","import React, { useEffect, useCallback, useState } from \"react\";\nimport moment from \"moment\";\nimport Tooltip from \"react-tooltip\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  updateWallPost,\n  getUserWallPostContent,\n  getUserWallPostInfo\n} from \"../../actions/UserActions\";\nimport { listenPath, gunUser } from \"../../utils/Gun\";\n\nimport Post from \".\";\n\nimport av1 from \"../../images/av1.jpg\";\nimport \"../Post/css/index.css\";\nimport { attachMedia } from \"../../utils/Torrents\";\nimport Loader from \"../Loader\";\nimport NoticeBar from \"./components/NoticeBar\";\n\nconst SharedPost = ({\n  sharedPostId,\n  sharerPublicKey,\n  sharerUsername,\n  sharerAvatar,\n  sharedTimestamp,\n  isOnlineNode,\n  postID,\n  postPublicKey,\n  pinned\n}) => {\n  const dispatch = useDispatch();\n  const [postLoading, setPostLoading] = useState(true);\n  const [postContent, setPostContent] = useState(null);\n  const [postUser, setPostUser] = useState(null);\n\n  useEffect(() => {\n    listenPath({\n      path: `posts/${sharedPostId}/tipCounter`,\n      gunPointer: gunUser(sharerPublicKey),\n      callback: data => {\n        dispatch(\n          updateWallPost({\n            postID: sharedPostId,\n            data: {\n              tipCounter: data\n            }\n          })\n        );\n      }\n    });\n    listenPath({\n      path: `posts/${sharedPostId}/tipValue`,\n      gunPointer: gunUser(sharerPublicKey),\n      callback: data => {\n        dispatch(\n          updateWallPost({\n            postID: sharedPostId,\n            data: {\n              tipValue: data\n            }\n          })\n        );\n      }\n    });\n  }, [dispatch, sharedPostId, sharerPublicKey]);\n\n  const loadPostUser = useCallback(async () => {\n    const userInfo = await dispatch(\n      getUserWallPostInfo({ publicKey: postPublicKey, id: postID })\n    );\n    setPostUser(userInfo);\n  }, [dispatch, postID, postPublicKey]);\n\n  const loadPostContent = useCallback(async () => {\n    const userPost = await dispatch(\n      getUserWallPostContent({ publicKey: postPublicKey, id: postID })\n    );\n    setPostContent(userPost);\n    setPostLoading(false);\n    attachMedia([userPost], false);\n  }, [dispatch, postID, postPublicKey]);\n\n  const loadPost = useCallback(async () => {\n    setPostLoading(true);\n    if (!postPublicKey) return;\n    loadPostUser();\n    loadPostContent();\n  }, [loadPostContent, loadPostUser, postPublicKey]);\n\n  useEffect(() => {\n    Tooltip.rebuild();\n    loadPost();\n  }, [loadPost]);\n\n  return (\n    <div className=\"post shared-post\">\n      <NoticeBar text=\"Linked post\" visible={pinned} />\n      <div className=\"head\">\n        <div className=\"user\">\n          <div\n            className=\"av\"\n            style={{\n              backgroundImage: `url(${sharerAvatar})`\n            }}\n          ></div>\n          <div className=\"details\">\n            <p>{sharerUsername}</p>\n            <p>{moment.utc(sharedTimestamp).fromNow()}</p>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"shared-content\">\n        {postLoading ? (\n          <Loader text=\"Loading Post...\" />\n        ) : postContent && postUser ? (\n          <Post\n            id={postContent.id}\n            timestamp={postContent.date}\n            avatar={\n              postUser.avatar ? `data:image/png;base64,${postUser.avatar}` : av1\n            }\n            tipCounter={postContent.tipCounter}\n            tipValue={postContent.tipValue}\n            publicKey={postPublicKey}\n            contentItems={postContent.contentItems}\n            username={postUser.displayName ?? postUser.alias}\n            isOnlineNode={isOnlineNode}\n            shared={true}\n            pinned={pinned}\n          />\n        ) : null}\n      </div>\n    </div>\n  );\n};\n\nexport default SharedPost;\n"],"sourceRoot":""}