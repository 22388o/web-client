{"version":3,"sources":["images/av1.jpg","utils/Cache.js","utils/Promise.js","utils/Torrents.js","images/banner-bg.jpg","images/lightning-logo.svg","pages/User/index.js"],"names":["module","exports","getCachedFile","fileName","a","FileCache","_init","Promise","resolve","reject","init","then","console","log","persist","status","persistent","load","cachedFile","createURL","warn","renderCachedFile","fileURL","selector","elements","document","querySelectorAll","length","forEach","element","src","muted","autoplay","saveFile","buffer","save","runSerial","tasks","result","task","supportedFileTypes","formats","options","_getFileType","file","extension","name","split","slice","supportedFileType","Object","entries","filter","includes","fileType","webTorrentClient","WebTorrent","attachMedia","posts","torrentMode","torrentTasks","map","post","contentItems","id","item","type","key","get","magnetURI","add","torrent","files","target","destroy","torrentElements","torrentElement","contentURL","decodeURIComponent","replace","format","toLowerCase","endsWith","compatibleURL","setAttribute","renderTo","on","getBlob","err","blob","querySelector","dataset","played","reduce","torrents","Post","React","lazy","SharedPost","UserPage","dispatch","useDispatch","params","useParams","wall","useSelector","user","profile","me","auth","pair","paymentRequest","transaction","useState","setUserLoading","wallLoading","setWallLoading","tipModalOpen","setTipModalOpen","tipLoading","setTipLoading","tipAmount","setTipAmount","isOnlineApp","setIsOnlineApp","isOnlineNode","setIsOnlineNode","copied","setCopied","onlineCheckTimer","setOnlineCheckTimer","targetType","tipMetadata","setTipMetadata","publicKey","userId","fetchUserData","useCallback","resetUserData","getUserProfile","getUserHeader","getUserAvatar","error","fetchUserWall","resetUserWall","getUserWall","sendTip","payUser","senderPair","recipientPublicKey","amount","metadata","openTipModal","closeTipModal","resetPaymentRequest","initializeUserWall","generateGunPair","useEffect","lastSeenAppListener","listenPath","path","gunPointer","gunUser","callback","event","updateUserProfile","lastSeenApp","lastSeenNodeListener","lastSeenNode","displayNameListener","displayName","bioListener","bio","off","clearTimeout","timer","setTimeout","onlineThreshold","Moment","utc","subtract","isSameOrAfter","setCopiedStatus","ReactTooltip","rebuild","username","alias","renderPost","avatar","av1","fallback","className","text","postID","postPublicKey","originalAuthor","sharedPostId","sharedTimestamp","date","sharerAvatar","sharerPublicKey","sharerUsername","timestamp","page","tipValue","tipCounter","style","backgroundImage","header","defaultBanner","color","onClick","opacity","cursor","data-tip","shockLogo","alt","value","size","bgColor","fgColor","href","onCopy","onChange","e","isIOS","rel"],"mappings":"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","file":"static/js/5.ab449953.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/av1.48bf5c6a.jpg\";","import FileCache from \"browser-file-storage\";\n\nexport const DB_NAME = \"ShockWalletStore\";\n\nexport const init = () =>\n  new Promise((resolve, reject) => {\n    FileCache.init(DB_NAME)\n      .then(() => {\n        console.log(\"File cache initialized!\");\n        return FileCache.persist();\n      })\n      .then(status => {\n        if (status.persistent) {\n          resolve(status);\n        } else {\n          reject(status);\n        }\n      });\n  });\n\nexport const getCachedFile = async fileName => {\n  try {\n    if (!FileCache._init) {\n      await init();\n    }\n\n    const cachedFile = await FileCache.load(fileName);\n    return cachedFile.createURL();\n  } catch (err) {\n    console.warn(err);\n    return false;\n  }\n};\n\nexport const renderCachedFile = (fileURL, selector) => {\n  const elements = document.querySelectorAll(selector);\n  if (elements && elements.length) {\n    elements.forEach(element => {\n      element.src = fileURL;\n      element.muted = true;\n      element.autoplay = true;\n    });\n  }\n  return !!elements && !!elements.length;\n};\n\nexport const saveFile = (fileName, buffer) => {\n  return FileCache.save(fileName, buffer);\n};\n","export const runSerial = tasks => {\n  let result = Promise.resolve();\n  tasks.forEach(task => {\n    result = result.then(() => task());\n  });\n  return result;\n};\n","import WebTorrent from \"webtorrent\";\nimport { getCachedFile, renderCachedFile, saveFile } from \"./Cache\";\nimport { runSerial } from \"./Promise\";\n\nconst supportedFileTypes = {\n  \"video/embedded\": {\n    formats: [\"mp4\", \"webm\"],\n    element: \"video\",\n    options: {\n      autoplay: true,\n      muted: true\n    }\n  },\n  \"image/embedded\": {\n    formats: [\"jpg\", \"png\", \"webp\", \"jpeg\"],\n    element: \"img\",\n    options: {}\n  }\n};\n\nconst _getFileType = file => {\n  const extension = file.name?.split(\".\")?.slice(-1)[0];\n  const supportedFileType = Object.entries(\n    supportedFileTypes\n  ).filter(([type, options]) => options.formats.includes(extension))[0];\n\n  if (supportedFileType) {\n    const [name, fileType] = supportedFileType;\n    return {\n      name,\n      ...fileType\n    };\n  }\n\n  return null;\n};\n\nexport const webTorrentClient = new WebTorrent();\n\nexport const attachMedia = (posts = [], torrentMode = true) => {\n  const torrentTasks = posts\n    .map(post => {\n      const { contentItems, id } = post;\n      return Object.entries(contentItems)\n        .filter(([key, item]) => supportedFileTypes[item.type])\n        .map(([key, item]) => () =>\n          new Promise(resolve => {\n            const torrentExists = webTorrentClient.get(item.magnetURI);\n\n            if (torrentExists) {\n              resolve(true);\n              return;\n            }\n\n            webTorrentClient.add(item.magnetURI, async torrent => {\n              // Proceed to the next torrent in queue\n              resolve(true);\n\n              const files = torrent.files.filter(file => {\n                const extension = file.name?.split(\".\")?.slice(-1)[0];\n                const supportedFileType = Object.entries(\n                  supportedFileTypes\n                ).filter(([type, options]) =>\n                  options.formats.includes(extension)\n                )[0];\n                if (supportedFileType) {\n                  const [, fileType] = supportedFileType;\n                  const matched = fileType.formats.includes(extension);\n                  return matched;\n                }\n                return false;\n              });\n\n              files.map(async file => {\n                const fileType = _getFileType(file);\n\n                if (!fileType) {\n                  return;\n                }\n\n                const fileName = `${id}-${key}-${file.name}`;\n\n                const element = fileType.element;\n                const target = `${element}[data-torrent=\"${item.magnetURI}\"]`;\n                const cachedFile = await getCachedFile(fileName);\n\n                if (cachedFile) {\n                  const torrent = webTorrentClient.get(item.magnetURI);\n\n                  if (torrent) {\n                    torrent.destroy();\n                  }\n\n                  renderCachedFile(cachedFile, target);\n                  return;\n                }\n\n                const torrentElements = document.querySelectorAll(target);\n                console.log(\"Torrent Elements:\", torrentElements);\n                torrentElements.forEach(torrentElement => {\n                  const contentURL = decodeURIComponent(\n                    item.magnetURI.replace(/.*(ws=)/gi, \"\")\n                  );\n                  const [compatibleURL] = fileType.formats.filter(format =>\n                    contentURL\n                      .toLowerCase()\n                      .endsWith(`.${format.toLowerCase()}`)\n                  );\n\n                  if (torrentMode || !compatibleURL) {\n                    file.renderTo(torrentElement, fileType.options);\n                    return;\n                  }\n\n                  torrentElement.setAttribute(\"src\", contentURL);\n                });\n              });\n\n              torrent.on(\"done\", () => {\n                files.map(file => {\n                  const fileType = _getFileType(file);\n                  const fileName = `${id}-${key}-${file.name}`;\n                  const element = fileType.element;\n                  const target = `${element}[data-torrent=\"${item.magnetURI}\"]`;\n\n                  file.getBlob(async (err, blob) => {\n                    if (err) {\n                      console.warn(err);\n                      return;\n                    }\n\n                    console.log(\"Caching loaded file...\", fileName, blob);\n                    await saveFile(fileName, blob);\n                    const element = document.querySelector(target);\n                    if (element.dataset.played === \"false\") {\n                      const cachedFile = await getCachedFile(fileName);\n                      renderCachedFile(cachedFile, target);\n                    }\n                  });\n                });\n              });\n            });\n          })\n        );\n    })\n    .reduce((torrents, contentItems) => [...torrents, ...contentItems], []);\n\n  runSerial(torrentTasks);\n};\n","module.exports = __webpack_public_path__ + \"static/media/banner-bg.f59337b5.jpg\";","module.exports = __webpack_public_path__ + \"static/media/lightning-logo.ea3bd789.svg\";","import React, { useEffect, useState, useCallback, Suspense } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useParams } from \"react-router-dom\";\nimport QRCode from \"react-qr-code\";\nimport Moment from \"moment\";\nimport CopyClipboard from \"react-copy-to-clipboard\";\nimport { isIOS } from \"react-device-detect\";\n\nimport {\n  getUserWall,\n  resetUserWall,\n  resetUserData,\n  getUserProfile,\n  getUserAvatar,\n  updateUserProfile,\n  getUserHeader\n} from \"../../actions/UserActions\";\nimport { generateGunPair } from \"../../actions/AuthActions\";\nimport { payUser, resetPaymentRequest } from \"../../actions/TransactionActions\";\nimport { listenPath, gunUser } from \"../../utils/Gun\";\nimport { webTorrentClient, attachMedia } from \"../../utils/Torrents\";\n\nimport Loader from \"../../common/Loader\";\n\n// Assets\nimport defaultBanner from \"../../images/banner-bg.jpg\";\nimport av1 from \"../../images/av1.jpg\";\nimport shockLogo from \"../../images/lightning-logo.svg\";\nimport \"./css/index.css\";\nimport ReactTooltip from \"react-tooltip\";\n\nconst Post = React.lazy(() => import(\"../../common/Post\"));\nconst SharedPost = React.lazy(() => import(\"../../common/Post/SharedPost\"));\n\nconst ONLINE_INTERVAL = 1 * 30 * 1000;\n\nconst UserPage = () => {\n  const dispatch = useDispatch();\n  const params = useParams();\n  const wall = useSelector(({ user }) => user.wall);\n  const profile = useSelector(({ user }) => user.profile);\n  const me = useSelector(({ auth }) => auth.pair);\n  const paymentRequest = useSelector(\n    ({ transaction }) => transaction.paymentRequest\n  );\n  // Reserved for future use\n  // eslint-disable-next-line no-unused-vars\n  const [userLoading, setUserLoading] = useState(true);\n  const [wallLoading, setWallLoading] = useState(true);\n  const [tipModalOpen, setTipModalOpen] = useState(false);\n  const [tipLoading, setTipLoading] = useState(false);\n  const [tipAmount, setTipAmount] = useState(10);\n  const [isOnlineApp, setIsOnlineApp] = useState(false);\n  const [isOnlineNode, setIsOnlineNode] = useState(false);\n  const [copied, setCopied] = useState(false);\n\n  const [onlineCheckTimer, setOnlineCheckTimer] = useState(null);\n  const [tipMetadata, setTipMetadata] = useState({ targetType: \"user\" });\n\n  const publicKey = params.userId;\n\n  const fetchUserData = useCallback(async () => {\n    try {\n      setUserLoading(true);\n      dispatch(resetUserData());\n      const user = await dispatch(getUserProfile(publicKey));\n      console.log(user);\n      setUserLoading(false);\n      // Load user avatar in the background\n      dispatch(getUserHeader(publicKey));\n      await dispatch(getUserAvatar(publicKey));\n    } catch (err) {\n      console.error(err);\n      setUserLoading(false);\n    }\n  }, [dispatch, publicKey]);\n\n  const fetchUserWall = useCallback(async () => {\n    try {\n      console.log(\"Setting Loading status to:\", true);\n      setWallLoading(true);\n      dispatch(resetUserWall());\n      await dispatch(getUserWall(publicKey));\n      console.log(\"Setting Loading status to:\", false);\n      setWallLoading(false);\n    } catch (err) {\n      console.error(err);\n      console.log(\"Setting Loading status to:\", false);\n      setWallLoading(false);\n    }\n  }, [dispatch, publicKey]);\n\n  const sendTip = useCallback(async () => {\n    try {\n      setTipLoading(true);\n      await dispatch(\n        payUser({\n          senderPair: me,\n          recipientPublicKey: publicKey,\n          amount: tipAmount,\n          metadata: tipMetadata\n        })\n      );\n      setTipLoading(false);\n    } catch (err) {\n      console.error(err);\n    }\n  }, [dispatch, me, publicKey, tipAmount, tipMetadata]);\n\n  const openTipModal = (metadata = { targetType: \"user\" }) => {\n    setTipMetadata(metadata);\n    setTipModalOpen(true);\n  };\n\n  const closeTipModal = useCallback(() => {\n    setTipModalOpen(false);\n    setTipMetadata({});\n    if (paymentRequest) {\n      dispatch(resetPaymentRequest());\n      setTipLoading(false);\n    }\n  }, [dispatch, paymentRequest]);\n\n  const initializeUserWall = useCallback(async () => {\n    await fetchUserData();\n    await dispatch(generateGunPair());\n    fetchUserWall();\n  }, [dispatch, fetchUserData, fetchUserWall]);\n\n  useEffect(() => {\n    initializeUserWall();\n\n    // Subscribe for updates\n    const lastSeenAppListener = listenPath({\n      path: \"Profile/lastSeenApp\",\n      gunPointer: gunUser(publicKey),\n      callback: event => {\n        dispatch(updateUserProfile({ lastSeenApp: event }));\n      }\n    });\n\n    const lastSeenNodeListener = listenPath({\n      path: \"Profile/lastSeenNode\",\n      gunPointer: gunUser(publicKey),\n      callback: event => {\n        dispatch(updateUserProfile({ lastSeenNode: event }));\n      }\n    });\n\n    const displayNameListener = listenPath({\n      path: \"Profile/displayName\",\n      gunPointer: gunUser(publicKey),\n      callback: event => {\n        dispatch(updateUserProfile({ displayName: event }));\n      }\n    });\n\n    const bioListener = listenPath({\n      path: \"Profile/bio\",\n      gunPointer: gunUser(publicKey),\n      callback: event => {\n        dispatch(updateUserProfile({ bio: event }));\n      }\n    });\n\n    return () => {\n      lastSeenAppListener.off();\n      lastSeenNodeListener.off();\n      displayNameListener.off();\n      bioListener.off();\n    };\n  }, [dispatch, initializeUserWall, publicKey]);\n\n  useEffect(() => {\n    attachMedia(\n      wall.posts.filter(post => post.type === \"post\").map(post => post),\n      false\n    );\n  }, [wall.posts]);\n\n  useEffect(() => {\n    if (onlineCheckTimer) {\n      clearTimeout(onlineCheckTimer);\n    }\n\n    const timer = setTimeout(() => {\n      const onlineThreshold = Moment.utc().subtract(ONLINE_INTERVAL, \"ms\");\n      const isOnlineNode = profile.lastSeenNode\n        ? Moment.utc(profile.lastSeenNode).isSameOrAfter(onlineThreshold)\n        : false;\n      const isOnlineApp = profile.lastSeenApp\n        ? Moment.utc(profile.lastSeenApp).isSameOrAfter(onlineThreshold)\n        : false;\n\n      setIsOnlineNode(isOnlineNode);\n      setIsOnlineApp(isOnlineApp);\n    }, ONLINE_INTERVAL);\n\n    setOnlineCheckTimer(timer);\n\n    return () => clearTimeout(onlineCheckTimer);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [profile]);\n\n  useEffect(() => {\n    const onlineThreshold = Moment.utc().subtract(1, \"minutes\");\n    const isOnlineNode = profile?.lastSeenNode\n      ? Moment.utc(profile?.lastSeenNode).isSameOrAfter(onlineThreshold)\n      : false;\n    const isOnlineApp = profile?.lastSeenApp\n      ? Moment.utc(profile?.lastSeenApp).isSameOrAfter(onlineThreshold)\n      : false;\n\n    setIsOnlineNode(isOnlineNode);\n    setIsOnlineApp(isOnlineApp);\n  }, [profile]);\n\n  const setCopiedStatus = useCallback(() => {\n    setCopied(true);\n    ReactTooltip.rebuild();\n    setTimeout(() => {\n      setCopied(false);\n      ReactTooltip.rebuild();\n    }, 500);\n  }, []);\n\n  const username = profile.displayName ?? profile.alias;\n\n  const renderPost = useCallback(\n    post => {\n      const avatar = profile.avatar\n        ? `data:image/png;base64,${profile.avatar}`\n        : av1;\n\n      if (post.type === \"shared\") {\n        return (\n          <Suspense\n            fallback={\n              <div className=\"post-loading\">\n                <Loader text=\"Loading Post...\" />\n              </div>\n            }\n            key={post.id}\n          >\n            <SharedPost\n              postID={post.id}\n              postPublicKey={post.originalAuthor}\n              sharedPostId={post.id}\n              sharedTimestamp={post.date}\n              sharerAvatar={avatar}\n              sharerPublicKey={publicKey}\n              sharerUsername={username}\n              isOnlineNode={isOnlineNode}\n              openTipModal={openTipModal}\n            />\n          </Suspense>\n        );\n      }\n\n      if (post.type === \"post\") {\n        return (\n          <Suspense\n            fallback={\n              <div className=\"post-loading\">\n                <Loader text=\"Loading Post...\" />\n              </div>\n            }\n            key={post.id}\n          >\n            <Post\n              timestamp={post.date}\n              contentItems={post.contentItems}\n              username={username}\n              avatar={avatar}\n              publicKey={publicKey}\n              openTipModal={openTipModal}\n              webTorrentClient={webTorrentClient}\n              page={post.page}\n              id={post.id}\n              tipValue={post.tipValue ?? 0}\n              tipCounter={post.tipCounter ?? 0}\n              isOnlineNode={isOnlineNode}\n            />\n          </Suspense>\n        );\n      }\n    },\n    [isOnlineNode, profile.avatar, publicKey, username]\n  );\n\n  return (\n    <div className=\"user-page\">\n      <div\n        className=\"top-banner\"\n        style={{\n          backgroundImage: `url(${\n            profile.header\n              ? `data:image/png;base64,${profile.header}`\n              : defaultBanner\n          })`\n        }}\n      ></div>\n      <div className=\"user-details\">\n        <div\n          className=\"main-av\"\n          style={{\n            backgroundImage: `url(${\n              profile.avatar ? `data:image/png;base64,${profile.avatar}` : av1\n            })`\n          }}\n        ></div>\n\n        <div className=\"details\">\n          <div className=\"user-info\">\n            <p className=\"username\">{username}</p>\n\n            <div className=\"activity\">\n              <p\n                className=\"status\"\n                style={\n                  !isOnlineApp\n                    ? {\n                        color: isOnlineApp\n                          ? \"#01a33d\"\n                          : isOnlineNode\n                          ? \"#f2a900\"\n                          : \"#888\"\n                      }\n                    : {}\n                }\n              >\n                {isOnlineApp\n                  ? \"Active Recently\"\n                  : isOnlineNode\n                  ? \"Node Online\"\n                  : \"Node Offline\"}\n              </p>\n            </div>\n\n            {profile.bio ? (\n              <div className=\"desc\">\n                <p className=\"title\">Bio</p>\n                <p>{profile.bio}</p>\n              </div>\n            ) : null}\n          </div>\n\n          <div\n            className=\"send-tip-btn\"\n            onClick={() => openTipModal()}\n            style={{\n              opacity: isOnlineNode ? 1 : 0.5,\n              cursor: isOnlineNode ? \"pointer\" : \"default\"\n            }}\n            data-tip={\n              !isOnlineNode ? \"You can only tip users with online nodes\" : null\n            }\n          >\n            <img src={shockLogo} alt=\"Bitcoin Lightning\" />\n            <p>Send Tip</p>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"tabs-holder\">\n        <p className=\"tab active\">Feed</p>\n      </div>\n      <div className=\"posts-holder\">\n        {wall.posts.map(post => renderPost(post))}\n      </div>\n      {wallLoading ? (\n        <Loader text={`Loading ${wall.page >= 0 ? \"More\" : \"Wall\"} Posts...`} />\n      ) : null}\n      {tipModalOpen ? (\n        <div className=\"tip-modal-container\">\n          <div className=\"tip-modal-overlay\" onClick={closeTipModal}></div>\n          <div className=\"tip-modal\">\n            {tipLoading ? (\n              <div className=\"tip-modal-loading\">\n                <Loader text=\"Submitting Tip Request...\" />\n              </div>\n            ) : null}\n            <div className=\"tip-modal-head\">\n              <div className=\"tip-modal-title\">Send Tip</div>\n            </div>\n            {paymentRequest ? (\n              <div className=\"tip-modal-content\">\n                <p className=\"tip-modal-instructions\">\n                  We've successfully generated an invoice for you to tip, please\n                  scan the QR Code below using a Lightning wallet to pay it!\n                </p>\n                <div className=\"tip-modal-qr-code-container\">\n                  <QRCode\n                    className=\"tip-modal-qr-code\"\n                    value={paymentRequest}\n                    size={210}\n                    bgColor=\"#4db1ff\"\n                    fgColor=\"#1b2129\"\n                  />\n                </div>\n                <div className=\"tip-modal-action-btns\">\n                  <a\n                    href={`lightning:${paymentRequest}`}\n                    className=\"tip-modal-action-btn\"\n                  >\n                    PAY INVOICE\n                  </a>\n                  <CopyClipboard text={paymentRequest} onCopy={setCopiedStatus}>\n                    <div className=\"tip-modal-action-btn\">\n                      {copied ? \"INVOICE COPIED!\" : \"COPY INVOICE\"}\n                    </div>\n                  </CopyClipboard>\n                </div>\n              </div>\n            ) : (\n              <div className=\"tip-modal-content\">\n                <p className=\"tip-modal-instructions\">\n                  Please specify the amount of sats you'd like to tip this user\n                  with below and we'll generate an invoice for you to scan.\n                </p>\n                <input\n                  className=\"tip-modal-input\"\n                  value={tipAmount}\n                  onChange={e => setTipAmount(e.target.value)}\n                />\n              </div>\n            )}\n            {!paymentRequest ? (\n              <div className=\"tip-modal-footer\" onClick={() => sendTip()}>\n                <div className=\"tip-modal-submit\">SEND TIP</div>\n              </div>\n            ) : null}\n          </div>\n        </div>\n      ) : null}\n      {!isIOS ? (\n        <a\n          href=\"https://github.com/shocknet/wallet/releases\"\n          target=\"_blank\"\n          rel=\"noreferrer noopener\"\n          className=\"download-shockwallet-btn\"\n        >\n          <i className=\"download-shockwallet-btn-icon fab fa-android\"></i>\n          <p className=\"download-shockwallet-btn-text\">Download ShockWallet</p>\n        </a>\n      ) : null}\n    </div>\n  );\n};\n\nexport default UserPage;\n"],"sourceRoot":""}