(this["webpackJsonpshockwallet-web"]=this["webpackJsonpshockwallet-web"]||[]).push([[4],{277:function(e,t){},279:function(e,t){},287:function(e,t){},289:function(e,t){},299:function(e,t){},301:function(e,t){},309:function(e,t){},311:function(e,t){},316:function(e,t){},319:function(e,t){},320:function(e,t){},322:function(e,t){},324:function(e,t){},326:function(e,t){},340:function(e,t){},342:function(e,t){},347:function(e,t){},352:function(e,t){},354:function(e,t){},360:function(e,t){},362:function(e,t){},363:function(e,t){},364:function(e,t){},368:function(e,t){},370:function(e,t){},375:function(e,t){},379:function(e,t){},380:function(e,t){},384:function(e,t){},387:function(e,t){},390:function(e,t){},392:function(e,t){},402:function(e,t){},404:function(e,t){},414:function(e,t){},416:function(e,t){},430:function(e,t){},432:function(e,t){},442:function(e,t){},444:function(e,t){},451:function(e,t){},453:function(e,t,n){e.exports=n.p+"static/media/banner-bg.f59337b5.jpg"},454:function(e,t,n){e.exports=n.p+"static/media/av1.48bf5c6a.jpg"},455:function(e,t,n){e.exports=n.p+"static/media/lightning-logo.ea3bd789.svg"},456:function(e,t,n){},469:function(e,t,n){"use strict";n.r(t);var a=n(4),c=n.n(a),r=n(7),o=n(12),i=n(0),l=n.n(i),s=n(34),u=n(6),f=n(254),m=n.n(f),d=n(153),p=n.n(d),b=n(263),v=n.n(b),O=n(267),g=n(14),j=n(40),h=n(25),E=n(1),N=n(26),w=n(5),k=n(269),S=n.n(k),y=n(452),x=n.n(y),C=function(){var e=Object(r.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,x.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){x.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),x.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,x.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),I=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src=e,t.muted=!0,t.autoplay=!0})),!!n&&!!n.length},P=function(e,t){return x.a.save(e,t)},A=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},T={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},R=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(T).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];if(c){var r=Object(o.a)(c,2),i=r[0],l=r[1];return Object(w.a)({name:i},l)}return null},L=new S.a,U=n(37),q=n(453),V=n.n(q),W=n(454),z=n.n(W),B=n(455),D=n.n(B),Y=(n(456),n(35)),F=l.a.lazy((function(){return Promise.all([n.e(5),n.e(6)]).then(n.bind(null,470))}));t.default=function(){var e,t=Object(s.b)(),n=Object(u.g)(),a=Object(s.c)((function(e){return e.user.wall})),f=Object(s.c)((function(e){return e.user.profile})),d=Object(s.c)((function(e){return e.auth.pair})),b=Object(s.c)((function(e){return e.transaction.paymentRequest})),w=Object(i.useState)(!0),k=Object(o.a)(w,2),S=(k[0],k[1]),y=Object(i.useState)(!0),x=Object(o.a)(y,2),q=x[0],W=x[1],B=Object(i.useState)(!1),J=Object(o.a)(B,2),K=J[0],M=J[1],_=Object(i.useState)(!1),Q=Object(o.a)(_,2),G=Q[0],H=Q[1],X=Object(i.useState)(10),Z=Object(o.a)(X,2),$=Z[0],ee=Z[1],te=Object(i.useState)(!1),ne=Object(o.a)(te,2),ae=ne[0],ce=ne[1],re=Object(i.useState)(!1),oe=Object(o.a)(re,2),ie=oe[0],le=oe[1],se=Object(i.useState)(!1),ue=Object(o.a)(se,2),fe=ue[0],me=ue[1],de=Object(i.useState)(null),pe=Object(o.a)(de,2),be=pe[0],ve=pe[1],Oe=Object(i.useState)({targetType:"user"}),ge=Object(o.a)(Oe,2),je=ge[0],he=ge[1],Ee=n.userId,Ne=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S(!0),t(Object(g.f)()),e.next=5,t(Object(g.d)(Ee));case 5:return n=e.sent,console.log(n),S(!1),t(Object(g.c)(Ee)),e.next=11,t(Object(g.b)(Ee));case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),S(!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])}))),[t,Ee]),we=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Setting Loading status to:",!0),W(!0),t(Object(g.g)()),e.next=6,t(Object(g.e)(Ee));case 6:console.log("Setting Loading status to:",!1),W(!1),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),console.log("Setting Loading status to:",!1),W(!1);case 15:case"end":return e.stop()}}),e,null,[[0,10]])}))),[t,Ee]),ke=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,H(!0),e.next=4,t(Object(h.b)({senderPair:d,recipientPublicKey:Ee,amount:$,metadata:je}));case 4:H(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[t,d,Ee,$,je]),Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{targetType:"user"};he(e),M(!0)},ye=Object(i.useCallback)((function(){M(!1),he({}),b&&(t(Object(h.c)()),H(!1))}),[t,b]),xe=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ne();case 2:return e.next=4,t(Object(j.b)());case 4:we();case 5:case"end":return e.stop()}}),e)}))),[t,Ne,we]);Object(i.useEffect)((function(){xe();var e=Object(E.h)({path:"Profile/lastSeenApp",gunPointer:Object(E.g)(Ee),callback:function(e){t(Object(g.h)({lastSeenApp:e}))}}),n=Object(E.h)({path:"Profile/lastSeenNode",gunPointer:Object(E.g)(Ee),callback:function(e){t(Object(g.h)({lastSeenNode:e}))}}),a=Object(E.h)({path:"Profile/displayName",gunPointer:Object(E.g)(Ee),callback:function(e){t(Object(g.h)({displayName:e}))}}),c=Object(E.h)({path:"Profile/bio",gunPointer:Object(E.g)(Ee),callback:function(e){t(Object(g.h)({bio:e}))}});return function(){e.off(),n.off(),a.off(),c.off()}}),[t,xe,Ee]),Object(i.useEffect)((function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.map((function(e){var n=e.contentItems,a=e.id;return Object.entries(n).filter((function(e){var t=Object(o.a)(e,2),n=(t[0],t[1]);return T[n.type]})).map((function(e){var n=Object(o.a)(e,2),i=n[0],l=n[1];return function(){return new Promise((function(e){L.get(l.magnetURI)?e(!0):L.add(l.magnetURI,function(){var n=Object(r.a)(c.a.mark((function n(s){var u;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(!0),(u=s.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(T).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];return!!c&&Object(o.a)(c,2)[1].formats.includes(a)}))).map(function(){var e=Object(r.a)(c.a.mark((function e(n){var r,s,u,f,m,d,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=R(n)){e.next=3;break}return e.abrupt("return");case 3:return s="".concat(a,"-").concat(i,"-").concat(n.name),u=r.element,f="".concat(u,'[data-torrent="').concat(l.magnetURI,'"]'),e.next=8,C(s);case 8:if(!(m=e.sent)){e.next=14;break}return(d=L.get(l.magnetURI))&&d.destroy(),I(m,f),e.abrupt("return");case 14:p=document.querySelectorAll(f),console.log("Torrent Elements:",p),p.forEach((function(e){var a=decodeURIComponent(l.magnetURI.replace(/.*(ws=)/gi,"")),c=r.formats.filter((function(e){return a.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),i=Object(o.a)(c,1)[0];!t&&i?e.setAttribute("src",a):n.renderTo(e,r.options)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),s.on("done",(function(){u.map((function(e){var t=R(e),n="".concat(a,"-").concat(i,"-").concat(e.name),o=t.element,s="".concat(o,'[data-torrent="').concat(l.magnetURI,'"]');e.getBlob(function(){var e=Object(r.a)(c.a.mark((function e(t,a){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",n,a),e.next=6,P(n,a);case 6:if("false"!==document.querySelector(s).dataset.played){e.next=12;break}return e.next=10,C(n);case 10:r=e.sent,I(r,s);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}))}}))})).reduce((function(e,t){return[].concat(Object(N.a)(e),Object(N.a)(t))}),[]);A(n)}(a.posts,!1)}),[a.posts]),Object(i.useEffect)((function(){be&&clearTimeout(be);var e=setTimeout((function(){var e=p.a.utc().subtract(3e4,"ms"),t=!!f.lastSeenNode&&p.a.utc(f.lastSeenNode).isSameOrAfter(e),n=!!f.lastSeenApp&&p.a.utc(f.lastSeenApp).isSameOrAfter(e);le(t),ce(n)}),3e4);return ve(e),function(){return clearTimeout(be)}}),[f]),Object(i.useEffect)((function(){var e=p.a.utc().subtract(1,"minutes"),t=!!(null===f||void 0===f?void 0:f.lastSeenNode)&&p.a.utc(null===f||void 0===f?void 0:f.lastSeenNode).isSameOrAfter(e),n=!!(null===f||void 0===f?void 0:f.lastSeenApp)&&p.a.utc(null===f||void 0===f?void 0:f.lastSeenApp).isSameOrAfter(e);le(t),ce(n)}),[f]);var Ce=Object(i.useCallback)((function(){me(!0),Y.a.rebuild(),setTimeout((function(){me(!1),Y.a.rebuild()}),500)}),[]),Ie=null!==(e=f.displayName)&&void 0!==e?e:f.alias;return l.a.createElement("div",{className:"user-page"},l.a.createElement("div",{className:"top-banner",style:{backgroundImage:"url(".concat(f.header?"data:image/png;base64,".concat(f.header):V.a,")")}}),l.a.createElement("div",{className:"user-details"},l.a.createElement("div",{className:"main-av",style:{backgroundImage:"url(".concat(f.avatar?"data:image/png;base64,".concat(f.avatar):z.a,")")}}),l.a.createElement("div",{className:"details"},l.a.createElement("div",{className:"user-info"},l.a.createElement("p",{className:"username"},Ie),l.a.createElement("div",{className:"activity"},l.a.createElement("p",{className:"status",style:ae?{}:{color:ae?"#01a33d":ie?"#f2a900":"#888"}},ae?"Active Recently":ie?"Node Online":"Node Offline")),f.bio?l.a.createElement("div",{className:"desc"},l.a.createElement("p",{className:"title"},"Bio"),l.a.createElement("p",null,f.bio)):null),l.a.createElement("div",{className:"send-tip-btn",onClick:function(){return Se()},style:{opacity:ie?1:.5,cursor:ie?"pointer":"default"},"data-tip":ie?null:"You can only tip users with online nodes"},l.a.createElement("img",{src:D.a,alt:"Bitcoin Lightning"}),l.a.createElement("p",null,"Send Tip")))),l.a.createElement("div",{className:"tabs-holder"},l.a.createElement("p",{className:"tab active"},"Feed")),l.a.createElement("div",{className:"posts-holder"},a.posts.map((function(e){var t,n;return l.a.createElement(i.Suspense,{fallback:l.a.createElement("div",{className:"post-loading"},l.a.createElement(U.a,{text:"Loading Post..."})),key:e.id},l.a.createElement(F,{timestamp:e.date,contentItems:e.contentItems,username:Ie,avatar:f.avatar?"data:image/png;base64,".concat(f.avatar):z.a,publicKey:Ee,openTipModal:Se,webTorrentClient:L,page:e.page,id:e.id,tipValue:null!==(t=e.tipValue)&&void 0!==t?t:0,tipCounter:null!==(n=e.tipCounter)&&void 0!==n?n:0,isOnlineNode:ie}))}))),q?l.a.createElement(U.a,{text:"Loading ".concat(a.page>=0?"More":"Wall"," Posts...")}):null,K?l.a.createElement("div",{className:"tip-modal-container"},l.a.createElement("div",{className:"tip-modal-overlay",onClick:ye}),l.a.createElement("div",{className:"tip-modal"},G?l.a.createElement("div",{className:"tip-modal-loading"},l.a.createElement(U.a,{text:"Submitting Tip Request..."})):null,l.a.createElement("div",{className:"tip-modal-head"},l.a.createElement("div",{className:"tip-modal-title"},"Send Tip")),b?l.a.createElement("div",{className:"tip-modal-content"},l.a.createElement("p",{className:"tip-modal-instructions"},"We've successfully generated an invoice for you to tip, please scan the QR Code below using a Lightning wallet to pay it!"),l.a.createElement("div",{className:"tip-modal-qr-code-container"},l.a.createElement(m.a,{className:"tip-modal-qr-code",value:b,size:210,bgColor:"#4db1ff",fgColor:"#1b2129"})),l.a.createElement("div",{className:"tip-modal-action-btns"},l.a.createElement("a",{href:"lightning:".concat(b),className:"tip-modal-action-btn"},"PAY INVOICE"),l.a.createElement(v.a,{text:b,onCopy:Ce},l.a.createElement("div",{className:"tip-modal-action-btn"},fe?"INVOICE COPIED!":"COPY INVOICE")))):l.a.createElement("div",{className:"tip-modal-content"},l.a.createElement("p",{className:"tip-modal-instructions"},"Please specify the amount of sats you'd like to tip this user with below and we'll generate an invoice for you to scan."),l.a.createElement("input",{className:"tip-modal-input",value:$,onChange:function(e){return ee(e.target.value)}})),b?null:l.a.createElement("div",{className:"tip-modal-footer",onClick:function(){return ke()}},l.a.createElement("div",{className:"tip-modal-submit"},"SEND TIP")))):null,O.isIOS?null:l.a.createElement("a",{href:"https://github.com/shocknet/wallet/releases",target:"_blank",rel:"noreferrer noopener",className:"download-shockwallet-btn"},l.a.createElement("i",{className:"download-shockwallet-btn-icon fab fa-android"}),l.a.createElement("p",{className:"download-shockwallet-btn-text"},"Download ShockWallet")))}}}]);
//# sourceMappingURL=4.10ff0590.chunk.js.map