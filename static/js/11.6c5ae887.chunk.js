(this["webpackJsonpshockwallet-web"]=this["webpackJsonpshockwallet-web"]||[]).push([[11],{114:function(e,t,n){e.exports=n.p+"static/media/av1.48bf5c6a.jpg"},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(17),r=n(2),c=n.n(r),u=n(6),o=n(3),i=n(8),s=n(162),l=n.n(s),f=function(){var e=Object(u.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){l.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),l.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,l.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),b=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src=e,t.muted=!0,t.autoplay=!0})),!!n&&!!n.length},p=function(e,t){return l.a.save(e,t)},m=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},d={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},v=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],r=Object.entries(d).filter((function(e){var t=Object(i.a)(e,2);t[0];return t[1].formats.includes(a)})),c=Object(i.a)(r,1)[0];if(c){var u=Object(i.a)(c,2),s=u[0],l=u[1];return Object(o.a)({name:s},l)}return null},O=null,j=function(){var e=Object(u.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=5;break}return e.next=3,Promise.all([n.e(6),n.e(8)]).then(n.t.bind(null,536,7));case 3:t=e.sent,O=new t.default;case 5:return e.abrupt("return",O);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(u.a)(c.a.mark((function e(){var t,n,r,o=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.length>0&&void 0!==o[0]?o[0]:[],n=!(o.length>1&&void 0!==o[1])||o[1],r=t.map((function(e){var t=e.contentItems,a=e.id,r=Object.entries(t).filter((function(e){var t=Object(i.a)(e,2)[1];return d[t.type]}));return r?r.map((function(e){var t=Object(i.a)(e,2),r=t[0],o=t[1];return function(){return new Promise((function(e){j().then((function(t){t.get(o.magnetURI)?e(!0):t.add(o.magnetURI,function(){var s=Object(u.a)(c.a.mark((function s(l){var m;return c.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e(!0),(m=l.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],r=Object.entries(d).filter((function(e){return Object(i.a)(e,2)[1].formats.includes(a)}))[0];return!!r&&Object(i.a)(r,2)[1].formats.includes(a)}))).map(function(){var e=Object(u.a)(c.a.mark((function e(u){var s,l,p,m,d,O,j;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=v(u)){e.next=3;break}return e.abrupt("return");case 3:return l="".concat(a,"-").concat(r,"-").concat(u.name),p=s.element,m="".concat(p,'[data-torrent="').concat(o.magnetURI,'"]'),e.next=8,f(l);case 8:if(!(d=e.sent)){e.next=14;break}return(O=t.get(o.magnetURI))&&O.destroy(),b(d,m),e.abrupt("return");case 14:j=document.querySelectorAll(m),console.log("Torrent Elements:",j),j.forEach((function(e){var t=decodeURIComponent(o.magnetURI.replace(/.*(ws=)/gi,"")),a=s.formats.filter((function(e){return t.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),r=Object(i.a)(a,1)[0];!n&&r?e.setAttribute("src",t):u.renderTo(e,s.options)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l.on("done",(function(){m.map((function(e){var t=v(e),n="".concat(a,"-").concat(r,"-").concat(e.name),i=t.element,s="".concat(i,'[data-torrent="').concat(o.magnetURI,'"]');e.getBlob(function(){var e=Object(u.a)(c.a.mark((function e(t,a){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",n,a),e.next=6,p(n,a);case 6:if("false"!==document.querySelector(s).dataset.played){e.next=12;break}return e.next=10,f(n);case 10:r=e.sent,b(r,s);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 4:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}())}))}))}})):[]})).reduce((function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(t))}),[]),m(r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},129:function(e,t,n){"use strict";var a=n(8),r=n(0),c=n(32),u=n(113),o=n.n(u),i=n(1);t.a=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.user.profile})),u=Object(r.useState)(!1),s=Object(a.a)(u,2),l=s[0],f=s[1],b=Object(r.useState)(!1),p=Object(a.a)(b,2),m=p[0],d=p[1],v=Object(r.useState)(!1),O=Object(a.a)(v,2),j=O[0],h=O[1],g=Object(r.useState)(!1),k=Object(a.a)(g,2),w=k[0],E=k[1],y=Object(r.useState)(),x=Object(a.a)(y,2),S=x[0],N=x[1],P=Object(r.useCallback)((function(){var e=o.a.utc().subtract(1,"minutes"),t=o.a.utc(m).isSameOrAfter(e),n=o.a.utc(l).isSameOrAfter(e);E(t),h(n)}),[l,m]);return Object(r.useEffect)((function(){S&&clearTimeout(S),P();var e=setTimeout((function(){P()}),3e4);return N(e),function(){return clearTimeout(S)}}),[n,P]),Object(r.useEffect)((function(){var t=Object(i.h)({path:"Profile/lastSeenApp",gunPointer:Object(i.g)(e),callback:function(e){f(e)}}),n=Object(i.h)({path:"Profile/lastSeenNode",gunPointer:Object(i.g)(e),callback:function(e){d(e)}});return function(){t.off(),n.off()}}),[t,e]),{isOnlineApp:j,isOnlineNode:w}}},130:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(32),u=n(16),o=n(33),i=(n(131),r.a.lazy((function(){return Promise.all([n.e(2),n.e(9),n.e(14)]).then(n.bind(null,270))})));t.a=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.tip.modalOpen})),s=Object(a.useCallback)((function(){t(Object(u.b)())}),[t]),l=Object(a.useMemo)((function(){return r.a.createElement(o.a,{text:"Loading..."})}),[]);return n?r.a.createElement("div",{className:"modal-container"},r.a.createElement("div",{className:"modal-overlay",onClick:s}),r.a.createElement("div",{className:"modal-content"},r.a.createElement(a.Suspense,{fallback:l},r.a.createElement(i,e)))):null}},131:function(e,t,n){},280:function(e,t,n){},281:function(e,t,n){},539:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(6),u=n(8),o=n(0),i=n.n(o),s=n(32),l=n(5),f=n(13),b=n(121),p=n(129),m=n(33),d=(n(280),i.a.createElement("div",{className:"navbar-icon"})),v=function(e){var t=e.title,n=e.goBack;return i.a.createElement("div",{className:"navbar"},n?i.a.createElement("div",{className:"navbar-icon",onClick:n},i.a.createElement("i",{className:"fas fa-arrow-left"})):d,i.a.createElement("p",{className:"navbar-title"},t),d)},O=n(114),j=n.n(O),h=(n(281),n(130)),g=i.a.lazy((function(){return Promise.all([n.e(0),n.e(2),n.e(1)]).then(n.bind(null,275))})),k=i.a.lazy((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(13)]).then(n.bind(null,533))}));t.default=function(){var e=Object(s.b)(),t=Object(l.h)(),n=t.postId,a=t.type,d=t.userId,O=Object(l.g)(),w=Object(s.c)((function(e){return e.user.profile})),E=Object(s.c)((function(e){var t;return null===(t=e.user.wall)||void 0===t?void 0:t.pinnedPost})),y=Object(o.useState)(!0),x=Object(u.a)(y,2),S=x[0],N=x[1],P=Object(p.a)(d).isOnlineNode,C=Object(o.useMemo)((function(){var e,t;return null!==(e=null!==(t=w.displayName)&&void 0!==t?t:w.alias)&&void 0!==e?e:"POSTS"}),[w.alias,w.displayName]),I=Object(o.useCallback)(Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(Object(f.i)()),t.next=3,e(Object(f.g)(d));case 3:e(Object(f.d)(d));case 4:case"end":return t.stop()}}),t)}))),[e,d]),A=Object(o.useCallback)(Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(Object(f.c)({postId:n,type:a,publicKey:d}));case 1:case"end":return t.stop()}}),t)}))),[e,n,a,d]),U=Object(o.useCallback)(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),e.next=3,I();case 3:A(),N(!1);case 5:case"end":return e.stop()}}),e)}))),[A,I]),R=Object(o.useCallback)((function(){O.push("/".concat(d))}),[O,d]),L=Object(o.useCallback)((function(e){if(e){var t,n,a=w.avatar?"data:image/png;base64,".concat(w.avatar):j.a;if("shared"===e.type)return i.a.createElement(o.Suspense,{fallback:i.a.createElement("div",{className:"post-loading"},i.a.createElement(m.a,{text:"Loading Post..."})),key:e.id},i.a.createElement(k,{postID:e.id,postPublicKey:e.originalAuthor,sharedPostId:e.id,sharedTimestamp:e.date,sharerAvatar:a,sharerPublicKey:d,sharerUsername:C,isOnlineNode:P}));if("post"===e.type)return i.a.createElement(o.Suspense,{fallback:i.a.createElement("div",{className:"post-loading"},i.a.createElement(m.a,{text:"Loading Post..."})),key:e.id},i.a.createElement(g,{timestamp:e.date,contentItems:e.contentItems,username:C,avatar:a,publicKey:d,page:e.page,id:e.id,tipValue:null!==(t=e.tipValue)&&void 0!==t?t:0,tipCounter:null!==(n=e.tipCounter)&&void 0!==n?n:0,isOnlineNode:P,pinned:!0}))}}),[P,w.avatar,d,C]);return Object(o.useEffect)((function(){U()}),[U]),Object(o.useEffect)((function(){E&&Object(b.a)([E],!1)}),[E]),S?i.a.createElement(m.a,{text:"Loading Post..."}):i.a.createElement("div",{className:"post-page has-nav"},i.a.createElement(v,{title:C,goBack:R}),i.a.createElement("div",{className:"posts-container"},L(E)),i.a.createElement(h.a,{publicKey:d}))}}}]);
//# sourceMappingURL=11.6c5ae887.chunk.js.map