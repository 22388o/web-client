(this["webpackJsonpshockwallet-web"]=this["webpackJsonpshockwallet-web"]||[]).push([[5],{258:function(e,t,n){e.exports=n.p+"static/media/av1.48bf5c6a.jpg"},272:function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return h}));var a=n(16),c=n(3),r=n.n(c),o=n(7),i=n(5),l=n(9),s=n(290),u=n.n(s),f=n(473),m=n.n(f),d=function(){var e=Object(o.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,m.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){m.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),m.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,m.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src=e,t.muted=!0,t.autoplay=!0})),!!n&&!!n.length},b=function(e,t){return m.a.save(e,t)},v=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},O={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},g=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(O).filter((function(e){var t=Object(l.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];if(c){var r=Object(l.a)(c,2),o=r[0],s=r[1];return Object(i.a)({name:o},s)}return null},j=new u.a,h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.map((function(e){var n=e.contentItems,a=e.id;return Object.entries(n).filter((function(e){var t=Object(l.a)(e,2),n=(t[0],t[1]);return O[n.type]})).map((function(e){var n=Object(l.a)(e,2),c=n[0],i=n[1];return function(){return new Promise((function(e){j.get(i.magnetURI)?e(!0):j.add(i.magnetURI,function(){var n=Object(o.a)(r.a.mark((function n(s){var u;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(!0),(u=s.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(O).filter((function(e){var t=Object(l.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];return!!c&&Object(l.a)(c,2)[1].formats.includes(a)}))).map(function(){var e=Object(o.a)(r.a.mark((function e(n){var o,s,u,f,m,b,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=g(n)){e.next=3;break}return e.abrupt("return");case 3:return s="".concat(a,"-").concat(c,"-").concat(n.name),u=o.element,f="".concat(u,'[data-torrent="').concat(i.magnetURI,'"]'),e.next=8,d(s);case 8:if(!(m=e.sent)){e.next=14;break}return(b=j.get(i.magnetURI))&&b.destroy(),p(m,f),e.abrupt("return");case 14:v=document.querySelectorAll(f),console.log("Torrent Elements:",v),v.forEach((function(e){var a=decodeURIComponent(i.magnetURI.replace(/.*(ws=)/gi,"")),c=o.formats.filter((function(e){return a.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),r=Object(l.a)(c,1)[0];!t&&r?e.setAttribute("src",a):n.renderTo(e,o.options)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),s.on("done",(function(){u.map((function(e){var t=g(e),n="".concat(a,"-").concat(c,"-").concat(e.name),l=t.element,s="".concat(l,'[data-torrent="').concat(i.magnetURI,'"]');e.getBlob(function(){var e=Object(o.a)(r.a.mark((function e(t,a){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",n,a),e.next=6,b(n,a);case 6:if("false"!==document.querySelector(s).dataset.played){e.next=12;break}return e.next=10,d(n);case 10:c=e.sent,p(c,s);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}))}}))})).reduce((function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(t))}),[]);v(n)}},298:function(e,t){},300:function(e,t){},308:function(e,t){},310:function(e,t){},320:function(e,t){},322:function(e,t){},330:function(e,t){},332:function(e,t){},337:function(e,t){},340:function(e,t){},341:function(e,t){},343:function(e,t){},345:function(e,t){},347:function(e,t){},361:function(e,t){},363:function(e,t){},368:function(e,t){},373:function(e,t){},375:function(e,t){},381:function(e,t){},383:function(e,t){},384:function(e,t){},385:function(e,t){},389:function(e,t){},391:function(e,t){},396:function(e,t){},400:function(e,t){},401:function(e,t){},405:function(e,t){},408:function(e,t){},411:function(e,t){},413:function(e,t){},423:function(e,t){},425:function(e,t){},435:function(e,t){},437:function(e,t){},451:function(e,t){},453:function(e,t){},463:function(e,t){},465:function(e,t){},472:function(e,t){},474:function(e,t,n){e.exports=n.p+"static/media/banner-bg.f59337b5.jpg"},475:function(e,t,n){e.exports=n.p+"static/media/lightning-logo.ea3bd789.svg"},476:function(e,t,n){},530:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n.n(a),r=n(7),o=n(9),i=n(0),l=n.n(i),s=n(32),u=n(6),f=n(275),m=n.n(f),d=n(121),p=n.n(d),b=n(284),v=n.n(b),O=n(288),g=n(14),j=n(40),h=n(26),E=n(1),N=n(272),k=n(35),w=n(474),y=n.n(w),S=n(258),x=n.n(S),C=n(475),P=n.n(C),I=(n(476),n(33)),A=l.a.lazy((function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,154))})),T=l.a.lazy((function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,529))}));t.default=function(){var e,t=Object(s.b)(),n=Object(u.g)(),a=Object(s.c)((function(e){return e.user.wall})),f=Object(s.c)((function(e){return e.user.profile})),d=Object(s.c)((function(e){return e.auth.pair})),b=Object(s.c)((function(e){return e.transaction.paymentRequest})),w=Object(i.useState)(!0),S=Object(o.a)(w,2),C=(S[0],S[1]),R=Object(i.useState)(!0),L=Object(o.a)(R,2),U=L[0],q=L[1],V=Object(i.useState)(!1),W=Object(o.a)(V,2),z=W[0],K=W[1],B=Object(i.useState)(!1),D=Object(o.a)(B,2),M=D[0],Y=D[1],F=Object(i.useState)(10),J=Object(o.a)(F,2),_=J[0],Q=J[1],G=Object(i.useState)(!1),H=Object(o.a)(G,2),X=H[0],Z=H[1],$=Object(i.useState)(!1),ee=Object(o.a)($,2),te=ee[0],ne=ee[1],ae=Object(i.useState)(!1),ce=Object(o.a)(ae,2),re=ce[0],oe=ce[1],ie=Object(i.useState)(null),le=Object(o.a)(ie,2),se=le[0],ue=le[1],fe=Object(i.useState)({targetType:"user"}),me=Object(o.a)(fe,2),de=me[0],pe=me[1],be=n.userId,ve=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C(!0),t(Object(g.h)()),e.next=5,t(Object(g.f)(be));case 5:return n=e.sent,console.log(n),C(!1),t(Object(g.d)(be)),e.next=11,t(Object(g.c)(be));case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),C(!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])}))),[t,be]),Oe=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Setting Loading status to:",!0),q(!0),t(Object(g.i)()),e.next=6,t(Object(g.g)(be));case 6:console.log("Setting Loading status to:",!1),q(!1),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),console.log("Setting Loading status to:",!1),q(!1);case 15:case"end":return e.stop()}}),e,null,[[0,10]])}))),[t,be]),ge=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Y(!0),e.next=4,t(Object(h.b)({senderPair:d,recipientPublicKey:be,amount:_,metadata:de}));case 4:Y(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[t,d,be,_,de]),je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{targetType:"spontaneousPayment"};pe(e),K(!0)},he=Object(i.useCallback)((function(){K(!1),pe({}),b&&(t(Object(h.c)()),Y(!1))}),[t,b]),Ee=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve();case 2:return e.next=4,t(Object(j.b)());case 4:Oe();case 5:case"end":return e.stop()}}),e)}))),[t,ve,Oe]);Object(i.useEffect)((function(){Ee();var e=Object(E.h)({path:"Profile/lastSeenApp",gunPointer:Object(E.g)(be),callback:function(e){t(Object(g.j)({lastSeenApp:e}))}}),n=Object(E.h)({path:"Profile/lastSeenNode",gunPointer:Object(E.g)(be),callback:function(e){t(Object(g.j)({lastSeenNode:e}))}}),a=Object(E.h)({path:"Profile/displayName",gunPointer:Object(E.g)(be),callback:function(e){t(Object(g.j)({displayName:e}))}}),c=Object(E.h)({path:"Profile/bio",gunPointer:Object(E.g)(be),callback:function(e){t(Object(g.j)({bio:e}))}});return function(){e.off(),n.off(),a.off(),c.off()}}),[t,Ee,be]),Object(i.useEffect)((function(){Object(N.a)(a.posts.filter((function(e){return"post"===e.type})).map((function(e){return e})),!1)}),[a.posts]),Object(i.useEffect)((function(){se&&clearTimeout(se);var e=setTimeout((function(){var e=p.a.utc().subtract(3e4,"ms"),t=!!f.lastSeenNode&&p.a.utc(f.lastSeenNode).isSameOrAfter(e),n=!!f.lastSeenApp&&p.a.utc(f.lastSeenApp).isSameOrAfter(e);ne(t),Z(n)}),3e4);return ue(e),function(){return clearTimeout(se)}}),[f]),Object(i.useEffect)((function(){var e=p.a.utc().subtract(1,"minutes"),t=!!(null===f||void 0===f?void 0:f.lastSeenNode)&&p.a.utc(null===f||void 0===f?void 0:f.lastSeenNode).isSameOrAfter(e),n=!!(null===f||void 0===f?void 0:f.lastSeenApp)&&p.a.utc(null===f||void 0===f?void 0:f.lastSeenApp).isSameOrAfter(e);ne(t),Z(n)}),[f]);var Ne=Object(i.useCallback)((function(){oe(!0),I.a.rebuild(),setTimeout((function(){oe(!1),I.a.rebuild()}),500)}),[]),ke=null!==(e=f.displayName)&&void 0!==e?e:f.alias,we=Object(i.useCallback)((function(e){var t,n,a=f.avatar?"data:image/png;base64,".concat(f.avatar):x.a;return"shared"===e.type?l.a.createElement(i.Suspense,{fallback:l.a.createElement("div",{className:"post-loading"},l.a.createElement(k.a,{text:"Loading Post..."})),key:e.id},l.a.createElement(T,{postID:e.id,postPublicKey:e.originalAuthor,sharedPostId:e.id,sharedTimestamp:e.date,sharerAvatar:a,sharerPublicKey:be,sharerUsername:ke,isOnlineNode:te,openTipModal:je})):"post"===e.type?l.a.createElement(i.Suspense,{fallback:l.a.createElement("div",{className:"post-loading"},l.a.createElement(k.a,{text:"Loading Post..."})),key:e.id},l.a.createElement(A,{timestamp:e.date,contentItems:e.contentItems,username:ke,avatar:a,publicKey:be,openTipModal:je,webTorrentClient:N.b,page:e.page,id:e.id,tipValue:null!==(t=e.tipValue)&&void 0!==t?t:0,tipCounter:null!==(n=e.tipCounter)&&void 0!==n?n:0,isOnlineNode:te})):void 0}),[te,f.avatar,be,ke]);return l.a.createElement("div",{className:"user-page"},l.a.createElement("div",{className:"top-banner",style:{backgroundImage:"url(".concat(f.header?"data:image/png;base64,".concat(f.header):y.a,")")}}),l.a.createElement("div",{className:"user-details"},l.a.createElement("div",{className:"main-av",style:{backgroundImage:"url(".concat(f.avatar?"data:image/png;base64,".concat(f.avatar):x.a,")")}}),l.a.createElement("div",{className:"details"},l.a.createElement("div",{className:"user-info"},l.a.createElement("p",{className:"username"},ke),l.a.createElement("div",{className:"activity"},l.a.createElement("p",{className:"status",style:X?{}:{color:X?"#01a33d":te?"#f2a900":"#888"}},X?"Active Recently":te?"Node Online":"Node Offline")),f.bio?l.a.createElement("div",{className:"desc"},l.a.createElement("p",{className:"title"},"Bio"),l.a.createElement("p",null,f.bio)):null),l.a.createElement("div",{className:"send-tip-btn",onClick:function(){return je()},style:{opacity:te?1:.5,cursor:te?"pointer":"default"},"data-tip":te?null:"You can only tip users with online nodes"},l.a.createElement("img",{src:P.a,alt:"Bitcoin Lightning"}),l.a.createElement("p",null,"Send Tip")))),l.a.createElement("div",{className:"tabs-holder"},l.a.createElement("p",{className:"tab active"},"Feed")),l.a.createElement("div",{className:"posts-holder"},a.posts.map((function(e){return we(e)}))),U?l.a.createElement(k.a,{text:"Loading ".concat(a.page>=0?"More":"Wall"," Posts...")}):null,z?l.a.createElement("div",{className:"tip-modal-container"},l.a.createElement("div",{className:"tip-modal-overlay",onClick:he}),l.a.createElement("div",{className:"tip-modal"},M?l.a.createElement("div",{className:"tip-modal-loading"},l.a.createElement(k.a,{text:"Submitting Tip Request..."})):null,l.a.createElement("div",{className:"tip-modal-head"},l.a.createElement("div",{className:"tip-modal-title"},"Send Tip")),b?l.a.createElement("div",{className:"tip-modal-content"},l.a.createElement("p",{className:"tip-modal-instructions"},"We've successfully generated an invoice for you to tip, please scan the QR Code below using a Lightning wallet to pay it!"),l.a.createElement("div",{className:"tip-modal-qr-code-container"},l.a.createElement(m.a,{className:"tip-modal-qr-code",value:b,size:210,bgColor:"#4db1ff",fgColor:"#1b2129"})),l.a.createElement("div",{className:"tip-modal-action-btns"},l.a.createElement("a",{href:"lightning:".concat(b),className:"tip-modal-action-btn"},"PAY INVOICE"),l.a.createElement(v.a,{text:b,onCopy:Ne},l.a.createElement("div",{className:"tip-modal-action-btn"},re?"INVOICE COPIED!":"COPY INVOICE")))):l.a.createElement("div",{className:"tip-modal-content"},l.a.createElement("p",{className:"tip-modal-instructions"},"Please specify the amount of sats you'd like to tip this user with below and we'll generate an invoice for you to scan."),l.a.createElement("input",{className:"tip-modal-input",value:_,onChange:function(e){return Q(e.target.value)}})),b?null:l.a.createElement("div",{className:"tip-modal-footer",onClick:function(){return ge()}},l.a.createElement("div",{className:"tip-modal-submit"},"SEND TIP")))):null,O.isIOS?null:l.a.createElement("a",{href:"https://wallet.shock.pub",target:"_blank",rel:"noreferrer noopener",className:"download-shockwallet-btn"},l.a.createElement("i",{className:"download-shockwallet-btn-icon fab fa-user"}),l.a.createElement("p",{className:"download-shockwallet-btn-text"},"Create a ShockWallet")))}}}]);
//# sourceMappingURL=5.c01f8969.chunk.js.map