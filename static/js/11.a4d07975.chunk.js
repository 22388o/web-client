(this["webpackJsonpshockwallet-web"]=this["webpackJsonpshockwallet-web"]||[]).push([[11],{116:function(e,t,n){e.exports=n.p+"static/media/av1.48bf5c6a.jpg"},130:function(e,t,n){"use strict";var a=n(8),r=n(0),c=n(32),i=n(115),u=n.n(i),o=n(1);t.a=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.user.profile})),i=Object(r.useState)(!1),s=Object(a.a)(i,2),l=s[0],f=s[1],m=Object(r.useState)(!1),d=Object(a.a)(m,2),p=d[0],b=d[1],v=Object(r.useState)(!1),O=Object(a.a)(v,2),h=O[0],j=O[1],g=Object(r.useState)(!1),k=Object(a.a)(g,2),y=k[0],w=k[1],x=Object(r.useState)(),E=Object(a.a)(x,2),N=E[0],S=E[1],P=Object(r.useCallback)((function(){var e=u.a.utc().subtract(1,"minutes"),t=u.a.utc(p).isSameOrAfter(e),n=u.a.utc(l).isSameOrAfter(e);w(t),j(n)}),[l,p]);return Object(r.useEffect)((function(){N&&clearTimeout(N),P();var e=setTimeout((function(){P()}),3e4);return S(e),function(){return clearTimeout(N)}}),[n,P]),Object(r.useEffect)((function(){var t=Object(o.h)({path:"Profile/lastSeenApp",gunPointer:Object(o.g)(e),callback:function(e){f(e)}}),n=Object(o.h)({path:"Profile/lastSeenNode",gunPointer:Object(o.g)(e),callback:function(e){b(e)}});return function(){t.off(),n.off()}}),[t,e]),{isOnlineApp:h,isOnlineNode:y}}},131:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(32),i=n(16),u=n(33),o=(n(132),r.a.lazy((function(){return Promise.all([n.e(2),n.e(9),n.e(14)]).then(n.bind(null,273))})));t.a=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.tip.modalOpen})),s=Object(a.useCallback)((function(){t(Object(i.b)())}),[t]),l=Object(a.useMemo)((function(){return r.a.createElement(u.a,{text:"Loading..."})}),[]);return n?r.a.createElement("div",{className:"modal-container"},r.a.createElement("div",{className:"modal-overlay",onClick:s}),r.a.createElement("div",{className:"modal-content"},r.a.createElement(a.Suspense,{fallback:l},r.a.createElement(o,e)))):null}},132:function(e,t,n){},283:function(e,t,n){},284:function(e,t,n){},541:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(6),i=n(8),u=n(0),o=n.n(u),s=n(32),l=n(5),f=n(13),m=(n(87),n(130)),d=n(33),p=(n(283),o.a.createElement("div",{className:"navbar-icon"})),b=function(e){var t=e.title,n=e.goBack;return o.a.createElement("div",{className:"navbar"},n?o.a.createElement("div",{className:"navbar-icon",onClick:n},o.a.createElement("i",{className:"fas fa-arrow-left"})):p,o.a.createElement("p",{className:"navbar-title"},t),p)},v=n(116),O=n.n(v),h=(n(284),n(131)),j=o.a.lazy((function(){return Promise.all([n.e(0),n.e(2),n.e(1)]).then(n.bind(null,278))})),g=o.a.lazy((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(13)]).then(n.bind(null,535))}));t.default=function(){var e=Object(s.b)(),t=Object(l.h)(),n=t.postId,a=t.type,p=t.userId,v=Object(l.g)(),k=Object(s.c)((function(e){return e.user.profile})),y=Object(s.c)((function(e){var t;return null===(t=e.user.wall)||void 0===t?void 0:t.pinnedPost})),w=Object(u.useState)(!0),x=Object(i.a)(w,2),E=x[0],N=x[1],S=Object(m.a)(p).isOnlineNode,P=Object(u.useMemo)((function(){var e,t;return null!==(e=null!==(t=k.displayName)&&void 0!==t?t:k.alias)&&void 0!==e?e:"POSTS"}),[k.alias,k.displayName]),I=Object(u.useCallback)(Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(Object(f.i)()),t.next=3,e(Object(f.g)(p));case 3:e(Object(f.d)(p));case 4:case"end":return t.stop()}}),t)}))),[e,p]),C=Object(u.useCallback)(Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(Object(f.c)({postId:n,type:a,publicKey:p}));case 1:case"end":return t.stop()}}),t)}))),[e,n,a,p]),U=Object(u.useCallback)(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),e.next=3,I();case 3:C(),N(!1);case 5:case"end":return e.stop()}}),e)}))),[C,I]),R=Object(u.useCallback)((function(){v.push("/".concat(p))}),[v,p]),T=Object(u.useCallback)((function(e){if(e){var t,n,a=k.avatar?"data:image/png;base64,".concat(k.avatar):O.a;if("shared"===e.type)return o.a.createElement(u.Suspense,{fallback:o.a.createElement("div",{className:"post-loading"},o.a.createElement(d.a,{text:"Loading Post..."})),key:e.id},o.a.createElement(g,{postID:e.id,postPublicKey:e.originalAuthor,sharedPostId:e.id,sharedTimestamp:e.date,sharerAvatar:a,sharerPublicKey:p,sharerUsername:P,isOnlineNode:S}));if("post"===e.type)return o.a.createElement(u.Suspense,{fallback:o.a.createElement("div",{className:"post-loading"},o.a.createElement(d.a,{text:"Loading Post..."})),key:e.id},o.a.createElement(j,{timestamp:e.date,contentItems:e.contentItems,username:P,avatar:a,publicKey:p,page:e.page,id:e.id,tipValue:null!==(t=e.tipValue)&&void 0!==t?t:0,tipCounter:null!==(n=e.tipCounter)&&void 0!==n?n:0,isOnlineNode:S,pinned:!0}))}}),[S,k.avatar,p,P]);return Object(u.useEffect)((function(){U()}),[U]),E?o.a.createElement(d.a,{text:"Loading Post..."}):o.a.createElement("div",{className:"post-page has-nav"},o.a.createElement(b,{title:P,goBack:R}),o.a.createElement("div",{className:"posts-container"},T(y)),o.a.createElement(h.a,{publicKey:p}))}},87:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return x}));var a=n(2),r=n.n(a),c=n(6),i=n(3),u=n(8),o=n(17),s=n(164),l=n.n(s),f=function(){var e=Object(c.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){l.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),l.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,l.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),m=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src=e,t.muted=!0})),!!n&&!!n.length},d=function(e,t){return l.a.save(e,t)},p=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},b={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!1,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},v=Object.values(b).reduce((function(e,t){return[].concat(Object(o.a)(e),Object(o.a)(t.formats))}),[]),O=function(e){var t,n;if(!e)return null;var a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],r=Object.entries(b).filter((function(e){var t=Object(u.a)(e,2);t[0];return t[1].formats.includes(a)})),c=Object(u.a)(r,1)[0];if(c){var o=Object(u.a)(c,2),s=o[0],l=o[1];return Object(i.a)({name:s},l)}return null},h=null,j=function(){var e=Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=5;break}return e.next=3,Promise.all([n.e(6),n.e(8)]).then(n.t.bind(null,538,7));case 3:t=e.sent,h=new t.default;case 5:return e.abrupt("return",h);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(e){var t,n=e.thumbnailFile,a=e.fileType,r=e.item,c=O(n),i="".concat(null!==(t=null===c||void 0===c?void 0:c.element)&&void 0!==t?t:"img",'[data-torrent="').concat(r.magnetURI,'"]'),u='.dynamic-thumbnail[data-torrent="'.concat(r.magnetURI,'"]');n||"video"!==a.element||(document.querySelector(i).classList.add("hidden"),document.querySelector(u).classList.remove("hidden"))},k=function(e){var t=e.id,n=e.key;return function(e){return"".concat(t,"-").concat(n,"-").concat(e.name)}},y=function(e){var t=e.file,n=e.type,a=e.torrentMode,r=e.torrent,c=n.element,i="".concat(c,'[data-torrent="').concat(r.magnetURI,'"]'),o=document.querySelectorAll(i);console.log("Torrent Elements:",o),o.forEach((function(e){if(!e.classList.contains("hidden")){var c=decodeURIComponent(r.magnetURI.replace(/.*(ws=)/gi,"")),i=n.formats.filter((function(e){return c.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),o=Object(u.a)(i,1)[0];!a&&o?e.setAttribute("src",c):t.renderTo(e,n.options)}}))},w=function(e){var t=e.thumbnailFileNames,n=e.getCacheFileName,a=e.torrentMode;return function(){var e=Object(c.a)(r.a.mark((function e(c){var i,u,o,s,l,d,p,b,v,h,j,k;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=c.fileName,o=c.thumbnails,s=c.item,l=c.fileType,d=u.split(".").slice(0,-1).join("."),p="".concat(d,"-thumb"),b=t.indexOf(p),v=o[b],h=v?O(v):null,j="".concat(null!==(i=null===h||void 0===h?void 0:h.element)&&void 0!==i?i:"img",'[data-torrent="').concat(s.magnetURI,'"]'),"video"!==l.element||!v){e.next=16;break}return e.next=10,f(n(v));case 10:if(!(k=e.sent)){e.next=14;break}return m(k,j),e.abrupt("return");case 14:return y({file:v,type:h,torrentMode:a,torrent:s}),e.abrupt("return");case 16:if("video"!==l.element||v){e.next=19;break}return g({thumbnailFile:v,fileType:l,item:s}),e.abrupt("return");case 19:return e.abrupt("return",{thumbnailFile:v});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=function(){var e=Object(c.a)(r.a.mark((function e(){var t,n,a,i,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:[],n=!(s.length>1&&void 0!==s[1])||s[1],e.next=4,Promise.all(t.map(function(){var e=Object(c.a)(r.a.mark((function e(t){var a,i,o,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.contentItems,i=t.id,o=Object.entries(a).filter((function(e){var t=Object(u.a)(e,2)[1];return b[t.type]}))){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,j();case 6:return s=e.sent,e.abrupt("return",o.map((function(e){var t=Object(u.a)(e,2),a=t[0],o=t[1];return function(){return new Promise((function(e){var t=k({id:i,key:a});s.get(o.magnetURI)?e(!0):s.add(o.magnetURI,function(){var a=Object(c.a)(r.a.mark((function a(i){var u,l,p,v;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e(!0),u=i.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],r=Object.values(b).filter((function(e){return e.formats.includes(a)}))[0];return!!r&&r.formats.includes(a)})),l=u.filter((function(e){return e.name.match(/-thumb\.([\w\d]){2,4}$/gi)})),p=l.map((function(e){return e.name.replace(/\.([\w\d]){2,4}$/gi,"")})),v=w({getCacheFileName:t,thumbnailFileNames:p,torrentMode:n}),u.map(function(){var e=Object(c.a)(r.a.mark((function e(a){var c,i,u,d,b,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p.includes(a.name)){e.next=2;break}return e.abrupt("return");case 2:if(c=O(a)){e.next=5;break}return e.abrupt("return");case 5:return i=t(a),u=c.element,d="".concat(u,'[data-torrent="').concat(o.magnetURI,'"]'),e.next=10,f(i);case 10:if(b=e.sent,v({fileName:a.name,thumbnails:l,fileType:c,item:o}),!b){e.next=17;break}return(h=s.get(o.magnetURI))&&h.destroy(),m(b,d),e.abrupt("return");case 17:y({file:a,type:c,torrentMode:n,torrent:o});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.on("done",(function(){u.map((function(e){var n=O(e),a=t(e),i=n.element,u="".concat(i,'[data-torrent="').concat(o.magnetURI,'"]');e.getBlob(function(){var e=Object(c.a)(r.a.mark((function e(t,n){var c,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",a,n),e.next=6,d(a,n);case 6:if("false"!==(null===(c=document.querySelector(u))||void 0===c?void 0:c.dataset.played)||(null===c||void 0===c?void 0:c.getAttribute("src"))){e.next=12;break}return e.next=10,f(a);case 10:i=e.sent,m(i,u);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}))}})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:a=e.sent,i=a.reduce((function(e,t){return[].concat(Object(o.a)(e),Object(o.a)(t))}),[]),p(i);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=11.a4d07975.chunk.js.map