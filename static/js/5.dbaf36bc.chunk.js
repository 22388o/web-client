(this["webpackJsonpshockwallet-web"]=this["webpackJsonpshockwallet-web"]||[]).push([[5],{259:function(e,t,n){e.exports=n.p+"static/media/av1.48bf5c6a.jpg"},274:function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return h}));var a=n(16),c=n(2),r=n.n(c),o=n(6),i=n(3),s=n(8),l=n(291),u=n.n(l),d=n(474),f=n.n(d),m=function(){var e=Object(o.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,f.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){f.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),f.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,f.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src=e,t.muted=!0,t.autoplay=!0})),!!n&&!!n.length},b=function(e,t){return f.a.save(e,t)},v=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},O={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},g=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(O).filter((function(e){var t=Object(s.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];if(c){var r=Object(s.a)(c,2),o=r[0],l=r[1];return Object(i.a)({name:o},l)}return null},j=new u.a,h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.map((function(e){var n=e.contentItems,a=e.id;return Object.entries(n).filter((function(e){var t=Object(s.a)(e,2),n=(t[0],t[1]);return O[n.type]})).map((function(e){var n=Object(s.a)(e,2),c=n[0],i=n[1];return function(){return new Promise((function(e){j.get(i.magnetURI)?e(!0):j.add(i.magnetURI,function(){var n=Object(o.a)(r.a.mark((function n(l){var u;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(!0),(u=l.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],c=Object.entries(O).filter((function(e){var t=Object(s.a)(e,2);t[0];return t[1].formats.includes(a)}))[0];return!!c&&Object(s.a)(c,2)[1].formats.includes(a)}))).map(function(){var e=Object(o.a)(r.a.mark((function e(n){var o,l,u,d,f,b,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=g(n)){e.next=3;break}return e.abrupt("return");case 3:return l="".concat(a,"-").concat(c,"-").concat(n.name),u=o.element,d="".concat(u,'[data-torrent="').concat(i.magnetURI,'"]'),e.next=8,m(l);case 8:if(!(f=e.sent)){e.next=14;break}return(b=j.get(i.magnetURI))&&b.destroy(),p(f,d),e.abrupt("return");case 14:v=document.querySelectorAll(d),console.log("Torrent Elements:",v),v.forEach((function(e){var a=decodeURIComponent(i.magnetURI.replace(/.*(ws=)/gi,"")),c=o.formats.filter((function(e){return a.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),r=Object(s.a)(c,1)[0];!t&&r?e.setAttribute("src",a):n.renderTo(e,o.options)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l.on("done",(function(){u.map((function(e){var t=g(e),n="".concat(a,"-").concat(c,"-").concat(e.name),s=t.element,l="".concat(s,'[data-torrent="').concat(i.magnetURI,'"]');e.getBlob(function(){var e=Object(o.a)(r.a.mark((function e(t,a){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",n,a),e.next=6,b(n,a);case 6:if("false"!==document.querySelector(l).dataset.played){e.next=12;break}return e.next=10,m(n);case 10:c=e.sent,p(c,l);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}))}}))})).reduce((function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(t))}),[]);v(n)}},299:function(e,t){},301:function(e,t){},309:function(e,t){},311:function(e,t){},321:function(e,t){},323:function(e,t){},331:function(e,t){},333:function(e,t){},338:function(e,t){},341:function(e,t){},342:function(e,t){},344:function(e,t){},346:function(e,t){},348:function(e,t){},362:function(e,t){},364:function(e,t){},369:function(e,t){},374:function(e,t){},376:function(e,t){},382:function(e,t){},384:function(e,t){},385:function(e,t){},386:function(e,t){},390:function(e,t){},392:function(e,t){},397:function(e,t){},401:function(e,t){},402:function(e,t){},406:function(e,t){},409:function(e,t){},412:function(e,t){},414:function(e,t){},424:function(e,t){},426:function(e,t){},436:function(e,t){},438:function(e,t){},452:function(e,t){},454:function(e,t){},464:function(e,t){},466:function(e,t){},473:function(e,t){},475:function(e,t,n){},476:function(e,t,n){e.exports=n.p+"static/media/banner-bg.f59337b5.jpg"},477:function(e,t,n){e.exports=n.p+"static/media/lightning-logo.ea3bd789.svg"},478:function(e,t,n){},534:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),r=n(6),o=n(8),i=n(0),s=n.n(i),l=n(32),u=n(5),d=n(277),f=n.n(d),m=n(120),p=n.n(m),b=n(129),v=n.n(b),O=n(289),g=n(13),j=n(39),h=n(26),E=n(1),N=n(274),k=n(34),y=(n(475),function(e){var t=e.text;return s.a.createElement("div",{className:"divider-container"},s.a.createElement("div",{className:"dash"}),s.a.createElement("p",{className:"divider-text"},t),s.a.createElement("div",{className:"dash"}))}),w=n(476),S=n.n(w),x=n(259),P=n.n(x),C=n(477),I=n.n(C),A=(n(478),n(114)),T=s.a.lazy((function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,273))})),R=s.a.lazy((function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,532))}));t.default=function(){var e,t=Object(l.b)(),n=Object(u.g)(),a=Object(l.c)((function(e){return e.user.wall})),d=Object(l.c)((function(e){return e.user.profile})),m=Object(l.c)((function(e){return e.auth.pair})),b=Object(l.c)((function(e){return e.transaction.paymentRequest})),w=Object(i.useState)(!0),x=Object(o.a)(w,2),C=(x[0],x[1]),L=Object(i.useState)(!0),U=Object(o.a)(L,2),q=U[0],K=U[1],V=Object(i.useState)(!1),z=Object(o.a)(V,2),M=z[0],W=z[1],B=Object(i.useState)(!1),D=Object(o.a)(B,2),Y=D[0],F=D[1],J=Object(i.useState)(10),_=Object(o.a)(J,2),Q=_[0],G=_[1],H=Object(i.useState)(!1),X=Object(o.a)(H,2),Z=X[0],$=X[1],ee=Object(i.useState)(!1),te=Object(o.a)(ee,2),ne=te[0],ae=te[1],ce=Object(i.useState)(!1),re=Object(o.a)(ce,2),oe=re[0],ie=re[1],se=Object(i.useState)(null),le=Object(o.a)(se,2),ue=le[0],de=le[1],fe=Object(i.useState)({targetType:"user"}),me=Object(o.a)(fe,2),pe=me[0],be=me[1],ve=n.userId,Oe=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{C(!0),t(Object(g.i)()),t(Object(g.g)(ve)),C(!1),t(Object(g.e)(ve)),t(Object(g.d)(ve))}catch(n){console.error(n),C(!1)}case 1:case"end":return e.stop()}}),e)}))),[t,ve]),ge=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Setting Loading status to:",!0),K(!0),t(Object(g.j)()),e.next=6,t(Object(g.h)(ve));case 6:console.log("Setting Loading status to:",!1),K(!1),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),console.log("Setting Loading status to:",!1),K(!1);case 15:case"end":return e.stop()}}),e,null,[[0,10]])}))),[t,ve]),je=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,F(!0),e.next=4,t(Object(h.b)({senderPair:m,recipientPublicKey:ve,amount:Q,metadata:pe}));case 4:F(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[t,m,ve,Q,pe]),he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{targetType:"spontaneousPayment"};be(e),W(!0)},Ee=Object(i.useCallback)((function(){W(!1),be({}),b&&(t(Object(h.c)()),F(!1))}),[t,b]),Ne=Object(i.useCallback)(Object(r.a)(c.a.mark((function e(){var a,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.postId,r=n.userId,o=n.type,e.next=3,Oe();case 3:return e.next=5,t(Object(j.b)());case 5:ge(),t(Object(g.c)({postId:a,publicKey:r,type:o}));case 7:case"end":return e.stop()}}),e)}))),[t,Oe,ge,n]);Object(i.useEffect)((function(){Ne();var e=Object(E.h)({path:"Profile/lastSeenApp",gunPointer:Object(E.g)(ve),callback:function(e){t(Object(g.k)({lastSeenApp:e}))}}),n=Object(E.h)({path:"Profile/lastSeenNode",gunPointer:Object(E.g)(ve),callback:function(e){t(Object(g.k)({lastSeenNode:e}))}}),a=Object(E.h)({path:"Profile/displayName",gunPointer:Object(E.g)(ve),callback:function(e){t(Object(g.k)({displayName:e}))}}),c=Object(E.h)({path:"Profile/bio",gunPointer:Object(E.g)(ve),callback:function(e){t(Object(g.k)({bio:e}))}});return function(){e.off(),n.off(),a.off(),c.off()}}),[t,Ne,ve]),Object(i.useEffect)((function(){Object(N.a)(a.posts.filter((function(e){return"post"===e.type})),!1)}),[a.posts]),Object(i.useEffect)((function(){ue&&clearTimeout(ue);var e=setTimeout((function(){var e=p.a.utc().subtract(3e4,"ms"),t=!!d.lastSeenNode&&p.a.utc(d.lastSeenNode).isSameOrAfter(e),n=!!d.lastSeenApp&&p.a.utc(d.lastSeenApp).isSameOrAfter(e);ae(t),$(n)}),3e4);return de(e),function(){return clearTimeout(ue)}}),[d]),Object(i.useEffect)((function(){var e=p.a.utc().subtract(1,"minutes"),t=!!(null===d||void 0===d?void 0:d.lastSeenNode)&&p.a.utc(null===d||void 0===d?void 0:d.lastSeenNode).isSameOrAfter(e),n=!!(null===d||void 0===d?void 0:d.lastSeenApp)&&p.a.utc(null===d||void 0===d?void 0:d.lastSeenApp).isSameOrAfter(e);ae(t),$(n)}),[d]);var ke=Object(i.useCallback)((function(){ie(!0),A.a.rebuild(),setTimeout((function(){ie(!1),A.a.rebuild()}),500)}),[]),ye=null!==(e=d.displayName)&&void 0!==e?e:d.alias,we=Object(i.useCallback)((function(e){if(e){var t,n,a=d.avatar?"data:image/png;base64,".concat(d.avatar):P.a;if("shared"===e.type)return s.a.createElement(i.Suspense,{fallback:s.a.createElement("div",{className:"post-loading"},s.a.createElement(k.a,{text:"Loading Post..."})),key:e.id},s.a.createElement(R,{postID:e.id,postPublicKey:e.originalAuthor,sharedPostId:e.id,sharedTimestamp:e.date,sharerAvatar:a,sharerPublicKey:ve,sharerUsername:ye,isOnlineNode:ne,openTipModal:he,pinned:e.pinned}));if("post"===e.type)return s.a.createElement(i.Suspense,{fallback:s.a.createElement("div",{className:"post-loading"},s.a.createElement(k.a,{text:"Loading Post..."})),key:e.id},s.a.createElement(T,{timestamp:e.date,contentItems:e.contentItems,username:ye,avatar:a,publicKey:ve,openTipModal:he,webTorrentClient:N.b,page:e.page,id:e.id,tipValue:null!==(t=e.tipValue)&&void 0!==t?t:0,tipCounter:null!==(n=e.tipCounter)&&void 0!==n?n:0,isOnlineNode:ne,pinned:e.pinned}))}}),[ne,d.avatar,ve,ye]);return s.a.createElement("div",{className:"user-page"},s.a.createElement("div",{className:"top-banner",style:{backgroundImage:"url(".concat(d.header?"data:image/png;base64,".concat(d.header):S.a,")")}}),s.a.createElement("div",{className:"user-details"},s.a.createElement("div",{className:"main-av",style:{backgroundImage:"url(".concat(d.avatar?"data:image/png;base64,".concat(d.avatar):P.a,")")}}),s.a.createElement("div",{className:"details"},s.a.createElement("div",{className:"user-info"},s.a.createElement("p",{className:"username"},ye),s.a.createElement("div",{className:"activity"},s.a.createElement("p",{className:"status",style:{color:Z?"#01a33d":ne?"#f2a900":"#888"}},Z?"Active Recently":ne?"Node Online":"Node Offline")),d.bio?s.a.createElement("div",{className:"desc"},s.a.createElement("p",{className:"title"},"Bio"),s.a.createElement("p",null,d.bio)):null),s.a.createElement("div",{className:"send-tip-btn",onClick:function(){return he()},style:{opacity:ne?1:.5,cursor:ne?"pointer":"default"},"data-tip":ne?null:"You can only tip users with online nodes"},s.a.createElement("img",{src:I.a,alt:"Bitcoin Lightning"}),s.a.createElement("p",null,"Send Tip")),s.a.createElement(A.a,{backgroundColor:"#3a4d67",effect:"solid"}))),s.a.createElement("div",{className:"tabs-holder"},s.a.createElement("p",{className:"tab active"},"Feed")),s.a.createElement("div",{className:"posts-holder"},we(a.pinnedPost),a.pinnedPost&&s.a.createElement(y,{text:"More Posts"}),a.posts.map(we)),q?s.a.createElement(k.a,{text:"Loading ".concat(a.page>=0?"More":"Wall"," Posts...")}):null,M?s.a.createElement("div",{className:"tip-modal-container"},s.a.createElement("div",{className:"tip-modal-overlay",onClick:Ee}),s.a.createElement("div",{className:"tip-modal"},Y?s.a.createElement("div",{className:"tip-modal-loading"},s.a.createElement(k.a,{text:"Submitting Tip Request..."})):null,s.a.createElement("div",{className:"tip-modal-head"},s.a.createElement("div",{className:"tip-modal-title"},"Send Tip")),b?s.a.createElement("div",{className:"tip-modal-content"},s.a.createElement("p",{className:"tip-modal-instructions"},"We've successfully generated an invoice for you to tip, please scan the QR Code below using a Lightning wallet to pay it!"),s.a.createElement("div",{className:"tip-modal-qr-code-container"},s.a.createElement(f.a,{className:"tip-modal-qr-code",value:b,size:210,bgColor:"#4db1ff",fgColor:"#1b2129"})),s.a.createElement("div",{className:"tip-modal-action-btns"},s.a.createElement("a",{href:"lightning:".concat(b),className:"tip-modal-action-btn"},"PAY INVOICE"),s.a.createElement(v.a,{text:b,onCopy:ke},s.a.createElement("div",{className:"tip-modal-action-btn"},oe?"INVOICE COPIED!":"COPY INVOICE")))):s.a.createElement("div",{className:"tip-modal-content"},s.a.createElement("p",{className:"tip-modal-instructions"},"Please specify the amount of sats you'd like to tip this user with below and we'll generate an invoice for you to scan."),s.a.createElement("input",{className:"tip-modal-input",value:Q,onChange:function(e){return G(e.target.value)}})),b?null:s.a.createElement("div",{className:"tip-modal-footer",onClick:je},s.a.createElement("div",{className:"tip-modal-submit"},"SEND TIP")))):null,O.isIOS?null:s.a.createElement("a",{href:"https://wallet.shock.pub",target:"_blank",rel:"noreferrer noopener",className:"download-shockwallet-btn"},s.a.createElement("i",{className:"download-shockwallet-btn-icon fas fa-user"}),s.a.createElement("p",{className:"download-shockwallet-btn-text"},"Create a Shockwallet")))}}}]);
//# sourceMappingURL=5.dbaf36bc.chunk.js.map