(this["webpackJsonpshockwallet-web"]=this["webpackJsonpshockwallet-web"]||[]).push([[11],{116:function(e,t,n){e.exports=n.p+"static/media/av1.48bf5c6a.jpg"},130:function(e,t,n){"use strict";var a=n(8),r=n(0),c=n(32),u=n(115),o=n.n(u),i=n(1);t.a=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.user.profile})),u=Object(r.useState)(!1),s=Object(a.a)(u,2),l=s[0],f=s[1],p=Object(r.useState)(!1),b=Object(a.a)(p,2),d=b[0],m=b[1],v=Object(r.useState)(!1),O=Object(a.a)(v,2),j=O[0],h=O[1],g=Object(r.useState)(!1),k=Object(a.a)(g,2),w=k[0],y=k[1],x=Object(r.useState)(),E=Object(a.a)(x,2),P=E[0],S=E[1],N=Object(r.useCallback)((function(){var e=o.a.utc().subtract(1,"minutes"),t=o.a.utc(d).isSameOrAfter(e),n=o.a.utc(l).isSameOrAfter(e);y(t),h(n)}),[l,d]);return Object(r.useEffect)((function(){P&&clearTimeout(P),N();var e=setTimeout((function(){N()}),3e4);return S(e),function(){return clearTimeout(P)}}),[n,N]),Object(r.useEffect)((function(){var t=Object(i.h)({path:"Profile/lastSeenApp",gunPointer:Object(i.g)(e),callback:function(e){f(e)}}),n=Object(i.h)({path:"Profile/lastSeenNode",gunPointer:Object(i.g)(e),callback:function(e){m(e)}});return function(){t.off(),n.off()}}),[t,e]),{isOnlineApp:j,isOnlineNode:w}}},131:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(32),u=n(16),o=n(33),i=(n(132),r.a.lazy((function(){return Promise.all([n.e(2),n.e(9),n.e(14)]).then(n.bind(null,273))})));t.a=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.tip.modalOpen})),s=Object(a.useCallback)((function(){t(Object(u.b)())}),[t]),l=Object(a.useMemo)((function(){return r.a.createElement(o.a,{text:"Loading..."})}),[]);return n?r.a.createElement("div",{className:"modal-container"},r.a.createElement("div",{className:"modal-overlay",onClick:s}),r.a.createElement("div",{className:"modal-content"},r.a.createElement(a.Suspense,{fallback:l},r.a.createElement(i,e)))):null}},132:function(e,t,n){},283:function(e,t,n){},284:function(e,t,n){},541:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(6),u=n(8),o=n(0),i=n.n(o),s=n(32),l=n(5),f=n(13),p=(n(87),n(130)),b=n(33),d=(n(283),i.a.createElement("div",{className:"navbar-icon"})),m=function(e){var t=e.title,n=e.goBack;return i.a.createElement("div",{className:"navbar"},n?i.a.createElement("div",{className:"navbar-icon",onClick:n},i.a.createElement("i",{className:"fas fa-arrow-left"})):d,i.a.createElement("p",{className:"navbar-title"},t),d)},v=n(116),O=n.n(v),j=(n(284),n(131)),h=i.a.lazy((function(){return Promise.all([n.e(0),n.e(2),n.e(1)]).then(n.bind(null,278))})),g=i.a.lazy((function(){return Promise.all([n.e(0),n.e(2),n.e(1),n.e(13)]).then(n.bind(null,535))}));t.default=function(){var e=Object(s.b)(),t=Object(l.h)(),n=t.postId,a=t.type,d=t.userId,v=Object(l.g)(),k=Object(s.c)((function(e){return e.user.profile})),w=Object(s.c)((function(e){var t;return null===(t=e.user.wall)||void 0===t?void 0:t.pinnedPost})),y=Object(o.useState)(!0),x=Object(u.a)(y,2),E=x[0],P=x[1],S=Object(p.a)(d).isOnlineNode,N=Object(o.useMemo)((function(){var e,t;return null!==(e=null!==(t=k.displayName)&&void 0!==t?t:k.alias)&&void 0!==e?e:"POSTS"}),[k.alias,k.displayName]),I=Object(o.useCallback)(Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(Object(f.i)()),t.next=3,e(Object(f.g)(d));case 3:e(Object(f.d)(d));case 4:case"end":return t.stop()}}),t)}))),[e,d]),C=Object(o.useCallback)(Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(Object(f.c)({postId:n,type:a,publicKey:d}));case 1:case"end":return t.stop()}}),t)}))),[e,n,a,d]),U=Object(o.useCallback)(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,I();case 3:C(),P(!1);case 5:case"end":return e.stop()}}),e)}))),[C,I]),A=Object(o.useCallback)((function(){v.push("/".concat(d))}),[v,d]),R=Object(o.useCallback)((function(e){if(e){var t,n,a=k.avatar?"data:image/png;base64,".concat(k.avatar):O.a;if("shared"===e.type)return i.a.createElement(o.Suspense,{fallback:i.a.createElement("div",{className:"post-loading"},i.a.createElement(b.a,{text:"Loading Post..."})),key:e.id},i.a.createElement(g,{postID:e.id,postPublicKey:e.originalAuthor,sharedPostId:e.id,sharedTimestamp:e.date,sharerAvatar:a,sharerPublicKey:d,sharerUsername:N,isOnlineNode:S}));if("post"===e.type)return i.a.createElement(o.Suspense,{fallback:i.a.createElement("div",{className:"post-loading"},i.a.createElement(b.a,{text:"Loading Post..."})),key:e.id},i.a.createElement(h,{timestamp:e.date,contentItems:e.contentItems,username:N,avatar:a,publicKey:d,page:e.page,id:e.id,tipValue:null!==(t=e.tipValue)&&void 0!==t?t:0,tipCounter:null!==(n=e.tipCounter)&&void 0!==n?n:0,isOnlineNode:S,pinned:!0}))}}),[S,k.avatar,d,N]);return Object(o.useEffect)((function(){U()}),[U]),E?i.a.createElement(b.a,{text:"Loading Post..."}):i.a.createElement("div",{className:"post-page has-nav"},i.a.createElement(m,{title:N,goBack:A}),i.a.createElement("div",{className:"posts-container"},R(w)),i.a.createElement(j.a,{publicKey:d}))}},87:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return w}));var a=n(2),r=n.n(a),c=n(6),u=n(3),o=n(8),i=n(17),s=n(164),l=n.n(s),f=function(){var e=Object(c.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l.a._init){e.next=4;break}return e.next=4,new Promise((function(e,t){l.a.init("ShockWalletStore").then((function(){return console.log("File cache initialized!"),l.a.persist()})).then((function(n){n.persistent?e(n):t(n)}))}));case 4:return e.next=6,l.a.load(t);case 6:return n=e.sent,e.abrupt("return",n.createURL());case 10:return e.prev=10,e.t0=e.catch(0),console.warn(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e,t){var n=document.querySelectorAll(t);return n&&n.length&&n.forEach((function(t){t.src=e,t.muted=!0,t.autoplay=!0})),!!n&&!!n.length},b=function(e,t){return l.a.save(e,t)},d=function(e){var t=Promise.resolve();return e.forEach((function(e){t=t.then((function(){return e()}))})),t},m={"video/embedded":{formats:["mp4","webm"],element:"video",options:{autoplay:!0,muted:!0}},"image/embedded":{formats:["jpg","png","webp","jpeg"],element:"img",options:{}}},v=Object.values(m).reduce((function(e,t){return[].concat(Object(i.a)(e),Object(i.a)(t.formats))}),[]),O=function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],r=Object.entries(m).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1].formats.includes(a)})),c=Object(o.a)(r,1)[0];if(c){var i=Object(o.a)(c,2),s=i[0],l=i[1];return Object(u.a)({name:s},l)}return null},j=null,h=function(){var e=Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=5;break}return e.next=3,Promise.all([n.e(6),n.e(8)]).then(n.t.bind(null,538,7));case 3:t=e.sent,j=new t.default;case 5:return e.abrupt("return",j);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(e){var t=e.id,n=e.key;return function(e){return"".concat(t,"-").concat(n,"-").concat(e.name)}},k=function(e){var t=e.file,n=e.type,a=e.torrentMode,r=e.torrent,c=n.element,u="".concat(c,'[data-torrent="').concat(r.magnetURI,'"]'),i=document.querySelectorAll(u);console.log("Torrent Elements:",i),i.forEach((function(e){var c=decodeURIComponent(r.magnetURI.replace(/.*(ws=)/gi,"")),u=n.formats.filter((function(e){return c.toLowerCase().endsWith(".".concat(e.toLowerCase()))})),i=Object(o.a)(u,1)[0];!a&&i?e.setAttribute("src",c):t.renderTo(e,n.options)}))},w=function(){var e=Object(c.a)(r.a.mark((function e(){var t,n,a,u,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:[],n=!(s.length>1&&void 0!==s[1])||s[1],e.next=4,Promise.all(t.map(function(){var e=Object(c.a)(r.a.mark((function e(t){var a,u,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.contentItems,u=t.id,i=Object.entries(a).filter((function(e){var t=Object(o.a)(e,2)[1];return m[t.type]}))){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,h();case 6:return s=e.sent,e.abrupt("return",i.map((function(e){var t=Object(o.a)(e,2),a=t[0],i=t[1];return function(){return new Promise((function(e){var t=g({id:u,key:a});s.get(i.magnetURI)?e(!0):s.add(i.magnetURI,function(){var a=Object(c.a)(r.a.mark((function a(u){var l,d,v;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e(!0),l=u.files.filter((function(e){var t,n,a=null===(t=e.name)||void 0===t||null===(n=t.split("."))||void 0===n?void 0:n.slice(-1)[0],r=Object.entries(m).filter((function(e){return Object(o.a)(e,2)[1].formats.includes(a)}))[0];return!!r&&Object(o.a)(r,2)[1].formats.includes(a)})),d=l.filter((function(e){return e.name.match(/-thumb\.([\w\d]){2,4}$/gi)})),v=d.map((function(e){return e.name.replace(/\.([\w\d]){2,4}$/gi,"")})),l.map(function(){var e=Object(c.a)(r.a.mark((function e(a){var c,u,o,l,b,m,j,h,g,w,y,x,E;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.includes(a.name)){e.next=2;break}return e.abrupt("return");case 2:if(c=O(a)){e.next=5;break}return e.abrupt("return");case 5:return u=t(a),o=c.element,l="".concat(o,'[data-torrent="').concat(i.magnetURI,'"]'),e.next=10,f(u);case 10:if(b=e.sent,m=u.split(".").slice(0,-1).join("."),j="".concat(m,"-thumb"),h=v.indexOf(j),g=d[h],w=g?O(g):null,!b){e.next=27;break}if((y=s.get(i.magnetURI))&&y.destroy(),"video"!==o||!g){e.next=25;break}return x="".concat(w.element,'[data-torrent="').concat(i.magnetURI,'"]'),e.next=23,f(t(g));case 23:E=e.sent,p(E,x);case 25:return p(b,l),e.abrupt("return");case 27:k({file:a,type:c,torrentMode:n,torrent:i}),g&&k({file:g,type:w,torrentMode:n,torrent:i});case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u.on("done",(function(){l.map((function(e){var n=O(e),a=t(e),u=n.element,o="".concat(u,'[data-torrent="').concat(i.magnetURI,'"]');e.getBlob(function(){var e=Object(c.a)(r.a.mark((function e(t,n){var c,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return console.warn(t),e.abrupt("return");case 3:return console.log("Caching loaded file...",a,n),e.next=6,b(a,n);case 6:if("false"!==(null===(c=document.querySelector(o))||void 0===c?void 0:c.dataset.played)||(null===c||void 0===c?void 0:c.getAttribute("src"))){e.next=12;break}return e.next=10,f(a);case 10:u=e.sent,p(u,o);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}))}));case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}))}})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:a=e.sent,u=a.reduce((function(e,t){return[].concat(Object(i.a)(e),Object(i.a)(t))}),[]),d(u);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=11.81808c6c.chunk.js.map